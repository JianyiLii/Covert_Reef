<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ðŸŒŠ Visual Analysis Finding ðŸª¸ â€“  Covert Reef ðŸª¸</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-36055dde38e1c66a85944b0e21486264.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><i class="fa-solid fa-water" aria-label="water"></i> Covert Reef ðŸª¸</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./proposal.html"> <i class="bi bi-files" role="img">
</i> 
<span class="menu-text">Proposal</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-fa-diagram-project--methodology" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text"><i class="fa-solid fa-diagram-project" aria-label="diagram-project"></i> Methodology</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-fa-diagram-project--methodology">    
        <li class="dropdown-header">methodology/1.qmd</li>
        <li class="dropdown-header">methodology/2.qmd</li>
        <li class="dropdown-header">methodology/3.qmd</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-findings" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-journal-text" role="img">
</i> 
 <span class="menu-text">Findings</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-findings">    
        <li>
    <a class="dropdown-item" href="./intro.html">
 <span class="dropdown-text">ðŸŒŠ Project Introduction ðŸª¸</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datapre.html">
 <span class="dropdown-text">ðŸŒŠ Data Preparation ðŸª¸</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tasks.html">
 <span class="dropdown-text">ðŸŒŠ Visual Analysis Finding ðŸª¸</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./poster.qmd"> 
<span class="menu-text"><i class="fa-solid fa-file-powerpoint" aria-label="file-powerpoint"></i> Poster</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./meeting_minutes.html"> <i class="bi bi-archive" role="img">
</i> 
<span class="menu-text">Meeting Minutes</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text"><i class="fa-solid fa-people-group" aria-label="people-group"></i> The Team</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-fa-laptop-code--shiny-app" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text"><i class="fa-solid fa-laptop-code" aria-label="laptop-code"></i> Shiny App</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-fa-laptop-code--shiny-app">    
        <li>
    <a class="dropdown-item" href="./user_guide.qmd">
 <span class="dropdown-text">User Guide</span></a>
  </li>  
        <li class="dropdown-header">Shiny App</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text">Github</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/JianyiLii/Group_Project-MC3" target="_blank">
 <span class="dropdown-text">Project Site</span></a>
  </li>  
        <li class="dropdown-header">Shiny App</li>
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tackling-question-1" id="toc-tackling-question-1" class="nav-link active" data-scroll-target="#tackling-question-1">** Tackling Question 1**</a>
  <ul class="collapse">
  <li><a href="#static-chord-diagram--all-communicators" id="toc-static-chord-diagram--all-communicators" class="nav-link" data-scroll-target="#static-chord-diagram--all-communicators">1.1.1 Static Chord Diagram- All Communicators</a></li>
  <li><a href="#interactive-chord-diagram-by-community" id="toc-interactive-chord-diagram-by-community" class="nav-link" data-scroll-target="#interactive-chord-diagram-by-community">1.1.2 Interactive Chord Diagram by Community</a></li>
  <li><a href="#heatmap-of-correspondences" id="toc-heatmap-of-correspondences" class="nav-link" data-scroll-target="#heatmap-of-correspondences">1.1.3 Heatmap of Correspondences</a></li>
  <li><a href="#heatmap-of-date-and-hours" id="toc-heatmap-of-date-and-hours" class="nav-link" data-scroll-target="#heatmap-of-date-and-hours">1.1.4 Heatmap of date and hours</a></li>
  <li><a href="#the-code-2" id="toc-the-code-2" class="nav-link" data-scroll-target="#the-code-2">The code</a></li>
  </ul></li>
  <li><a href="#tackling-question-2" id="toc-tackling-question-2" class="nav-link" data-scroll-target="#tackling-question-2"><strong>Tackling Question 2</strong></a></li>
  <li><a href="#question-2a" id="toc-question-2a" class="nav-link" data-scroll-target="#question-2a">Question 2a)</a>
  <ul class="collapse">
  <li><a href="#unique-count-from-each-sender-subtype" id="toc-unique-count-from-each-sender-subtype" class="nav-link" data-scroll-target="#unique-count-from-each-sender-subtype">2.1.1 Unique count from each sender subtype</a></li>
  <li><a href="#people-and-vessels" id="toc-people-and-vessels" class="nav-link" data-scroll-target="#people-and-vessels">2.2 People and Vessels</a>
  <ul class="collapse">
  <li><a href="#filter-by-vessel-and-person-only" id="toc-filter-by-vessel-and-person-only" class="nav-link" data-scroll-target="#filter-by-vessel-and-person-only">2.2.1 Filter by Vessel and Person only</a></li>
  <li><a href="#plotted-timeline--people-vessels" id="toc-plotted-timeline--people-vessels" class="nav-link" data-scroll-target="#plotted-timeline--people-vessels">2.2.2 Plotted Timeline- People &amp; Vessels</a></li>
  <li><a href="#suspicious-conversations" id="toc-suspicious-conversations" class="nav-link" data-scroll-target="#suspicious-conversations">2.3.1 Suspicious Conversations</a></li>
  <li><a href="#non-suspicious-conversations" id="toc-non-suspicious-conversations" class="nav-link" data-scroll-target="#non-suspicious-conversations">2.3.2 Non-suspicious conversations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#question-2b" id="toc-question-2b" class="nav-link" data-scroll-target="#question-2b">Question 2b)</a>
  <ul class="collapse">
  <li><a href="#centrality-measure--all" id="toc-centrality-measure--all" class="nav-link" data-scroll-target="#centrality-measure--all">7.5.2 Centrality Measure- All</a></li>
  <li><a href="#community-group-membership--all" id="toc-community-group-membership--all" class="nav-link" data-scroll-target="#community-group-membership--all">3.3.1 Community Group Membership- All</a></li>
  <li><a href="#centrality-measure--people-vessels" id="toc-centrality-measure--people-vessels" class="nav-link" data-scroll-target="#centrality-measure--people-vessels">7.5.8 Centrality Measure- People &amp; Vessels</a></li>
  <li><a href="#wordclouds--bigrams" id="toc-wordclouds--bigrams" class="nav-link" data-scroll-target="#wordclouds--bigrams">7.5.9 Wordclouds- Bigrams</a></li>
  <li><a href="#circular-barchart-for-top-bigrams-per-community" id="toc-circular-barchart-for-top-bigrams-per-community" class="nav-link" data-scroll-target="#circular-barchart-for-top-bigrams-per-community">7.5.10 Circular barchart for Top Bigrams per Community</a></li>
  <li><a href="#community-group-membership--people-vessels" id="toc-community-group-membership--people-vessels" class="nav-link" data-scroll-target="#community-group-membership--people-vessels">7.5.11 Community Group Membership- People &amp; Vessels</a></li>
  <li><a href="#discussion-interpretation" id="toc-discussion-interpretation" class="nav-link" data-scroll-target="#discussion-interpretation">7.5.13 Discussion/ Interpretation:</a></li>
  </ul></li>
  <li><a href="#tackling-question-3" id="toc-tackling-question-3" class="nav-link" data-scroll-target="#tackling-question-3"><strong>Tackling Question 3</strong></a></li>
  <li><a href="#question-3a" id="toc-question-3a" class="nav-link" data-scroll-target="#question-3a">Question 3a)</a>
  <ul class="collapse">
  <li><a href="#entities-breakdown" id="toc-entities-breakdown" class="nav-link" data-scroll-target="#entities-breakdown">8.1 Entities Breakdown</a></li>
  <li><a href="#entities--interactive-alluvial-diagrams" id="toc-entities--interactive-alluvial-diagrams" class="nav-link" data-scroll-target="#entities--interactive-alluvial-diagrams">Entities- Interactive Alluvial Diagrams</a></li>
  </ul></li>
  <li><a href="#question-3b" id="toc-question-3b" class="nav-link" data-scroll-target="#question-3b">Question 3b)</a></li>
  <li><a href="#question-3c" id="toc-question-3c" class="nav-link" data-scroll-target="#question-3c">Question 3c)</a></li>
  <li><a href="#tackling-question-4" id="toc-tackling-question-4" class="nav-link" data-scroll-target="#tackling-question-4"><strong>9) Tackling Question 4</strong></a></li>
  <li><a href="#question-4a" id="toc-question-4a" class="nav-link" data-scroll-target="#question-4a">Question 4a)</a>
  <ul class="collapse">
  <li><a href="#nadias-ego-network--louvain-community" id="toc-nadias-ego-network--louvain-community" class="nav-link" data-scroll-target="#nadias-ego-network--louvain-community">9.1 Nadiaâ€™s Ego Network- Louvain community</a></li>
  <li><a href="#nadias-sent-and-received-ego-networks--viznetwork" id="toc-nadias-sent-and-received-ego-networks--viznetwork" class="nav-link" data-scroll-target="#nadias-sent-and-received-ego-networks--viznetwork">9.2 Nadiaâ€™s Sent and Received Ego Networks- VizNetwork</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">9.2.1 Data Preparation</a></li>
  <li><a href="#nadias-sent-and-received-ego-networks" id="toc-nadias-sent-and-received-ego-networks" class="nav-link" data-scroll-target="#nadias-sent-and-received-ego-networks">9.2.2 Nadiaâ€™s Sent and Received Ego Networks</a></li>
  <li><a href="#sent-communications-network" id="toc-sent-communications-network" class="nav-link" data-scroll-target="#sent-communications-network">9.2.2.1 Sent Communications Network</a></li>
  <li><a href="#received-communications-network" id="toc-received-communications-network" class="nav-link" data-scroll-target="#received-communications-network">9.2.2.2 Received Communications Network</a></li>
  <li><a href="#findings-5" id="toc-findings-5" class="nav-link" data-scroll-target="#findings-5"><strong>9.2.3 Findings</strong>:</a></li>
  </ul></li>
  <li><a href="#nadias-ego-network-3-hops-degree-centrality" id="toc-nadias-ego-network-3-hops-degree-centrality" class="nav-link" data-scroll-target="#nadias-ego-network-3-hops-degree-centrality">9.3 Nadiaâ€™s Ego Network: 3-hops degree centrality</a></li>
  </ul></li>
  <li><a href="#question-4b" id="toc-question-4b" class="nav-link" data-scroll-target="#question-4b">Question 4b)</a>
  <ul class="collapse">
  <li><a href="#summary-of-nadias-actions" id="toc-summary-of-nadias-actions" class="nav-link" data-scroll-target="#summary-of-nadias-actions"><strong>9.4 Summary of Nadiaâ€™s Actions</strong></a>
  <ul class="collapse">
  <li><a href="#sequential-timeline-in-table-3-hop" id="toc-sequential-timeline-in-table-3-hop" class="nav-link" data-scroll-target="#sequential-timeline-in-table-3-hop">9.4.1 Sequential Timeline in Table (3-hop)</a></li>
  <li><a href="#plotted-timeline-3-hop--only-suspicious-communications" id="toc-plotted-timeline-3-hop--only-suspicious-communications" class="nav-link" data-scroll-target="#plotted-timeline-3-hop--only-suspicious-communications">9.4.2 Plotted Timeline (3-hop)- Only suspicious communications</a></li>
  <li><a href="#plotted-timeline-3-hop--full-communications" id="toc-plotted-timeline-3-hop--full-communications" class="nav-link" data-scroll-target="#plotted-timeline-3-hop--full-communications">Plotted Timeline (3-hop)- Full communications</a></li>
  </ul></li>
  <li><a href="#discussioninterpretation-1-3-hop-data" id="toc-discussioninterpretation-1-3-hop-data" class="nav-link" data-scroll-target="#discussioninterpretation-1-3-hop-data"><strong>9.5 Discussion/Interpretation (1 &amp; 3 hop data):</strong></a>
  <ul class="collapse">
  <li><a href="#the-community-and-ego-network" id="toc-the-community-and-ego-network" class="nav-link" data-scroll-target="#the-community-and-ego-network">9.5.1 The Community and Ego Network:</a></li>
  <li><a href="#the-communication-timeline-and-content" id="toc-the-communication-timeline-and-content" class="nav-link" data-scroll-target="#the-communication-timeline-and-content">9.5.2 The Communication Timeline and Content:</a></li>
  </ul></li>
  <li><a href="#querying-keywords" id="toc-querying-keywords" class="nav-link" data-scroll-target="#querying-keywords"><strong>9.6 Querying Keywords</strong></a>
  <ul class="collapse">
  <li><a href="#plotted-timeline-word-query-permit-related" id="toc-plotted-timeline-word-query-permit-related" class="nav-link" data-scroll-target="#plotted-timeline-word-query-permit-related">9.6.1 Plotted Timeline (Word Query: Permit related)</a></li>
  <li><a href="#findings-in-sequential-order" id="toc-findings-in-sequential-order" class="nav-link" data-scroll-target="#findings-in-sequential-order">9.6.1.1 Findings in sequential order:</a></li>
  <li><a href="#plotted-timeline-word-query-music-video-related" id="toc-plotted-timeline-word-query-music-video-related" class="nav-link" data-scroll-target="#plotted-timeline-word-query-music-video-related">9.6.2 Plotted Timeline (Word Query: Music Video Related)</a></li>
  <li><a href="#findings-through-questions-answers" id="toc-findings-through-questions-answers" class="nav-link" data-scroll-target="#findings-through-questions-answers">9.6.2.1 Findings through Questions &amp; Answers:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#recreation-of-story-line" id="toc-recreation-of-story-line" class="nav-link" data-scroll-target="#recreation-of-story-line"><strong>10) Recreation of Story-Line</strong></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><strong>11) References</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ðŸŒŠ Visual Analysis Finding ðŸª¸</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(jsonlite, tidyverse, ggtext,   </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               knitr, lubridate, hms, scales,   </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               tidytext, tm, SnowballC,   </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               patchwork, ggraph,    </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               tidygraph, igraph, ggiraph,    </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               SmartEDA, plotly, wordcloud,    </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               ggh4x, visNetwork, RColorBrewer, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               circlize, ggalluvial, reactable)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mc3_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc3_graph.json"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mc3_schema <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_schema.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>node_legend_colors_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"#88CCEE"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"#117733"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"#AA4499"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Group"</span><span class="ot">=</span> <span class="st">"#CC79A7"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event"</span> <span class="ot">=</span> <span class="st">"#DDCC77"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relationship"</span> <span class="ot">=</span> <span class="st">"#AF8DC3"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Nadia Conti"</span> <span class="ot">=</span> <span class="st">"red"</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>node_legend_shapes_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"dot"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"triangle"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"square"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"diamond"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Group"</span> <span class="ot">=</span> <span class="st">"circle plus"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event"</span> <span class="ot">=</span> <span class="st">"star"</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relationship"</span> <span class="ot">=</span> <span class="st">"square x"</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Nadia Conti"</span> <span class="ot">=</span> <span class="st">"star"</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>STYLES <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">node_label_dark =</span> <span class="st">"black"</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">font_family =</span> <span class="st">"Roboto Condensed"</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc3_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_raw <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc3_data<span class="sc">$</span>nodes)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_raw <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc3_data<span class="sc">$</span>edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpData</span>(<span class="at">data=</span>mc3_nodes_raw,<span class="at">type=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpData</span>(<span class="at">data=</span>mc3_edges_raw,<span class="at">type=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run ExpCatViz once at the top to avoid recomputing</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_nodes_raw,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"navyblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Count and reorder</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mc3_nodes_ordered <span class="ot">&lt;-</span> mc3_nodes_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>((n)) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_type =</span> <span class="fu">factor</span>(sub_type, <span class="at">levels =</span> sub_type))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Plot with navy bars, sorted, and horizontal</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mc3_nodes_ordered, <span class="fu">aes</span>(<span class="at">x =</span> sub_type, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"navy"</span>) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sub_type"</span>, <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Subtypes"</span>) <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter for type == "Entity", count sub_type, sort </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>relationship_subtypes <span class="ot">&lt;-</span> mc3_nodes_raw <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_type =</span> <span class="fu">factor</span>(sub_type, <span class="at">levels =</span> sub_type)) </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Plot</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(relationship_subtypes, <span class="fu">aes</span>(<span class="at">x =</span> sub_type, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"navy"</span>) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Entity Subtype"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Entity Subtypes"</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter for type == "Event", count sub_type, sort </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>relationship_subtypes <span class="ot">&lt;-</span> mc3_nodes_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_type =</span> <span class="fu">factor</span>(sub_type, <span class="at">levels =</span> sub_type)) </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Plot</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(relationship_subtypes, <span class="fu">aes</span>(<span class="at">x =</span> sub_type, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"navy"</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Event Subtype"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Event Subtypes"</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter for type == "Relationship", count sub_type, sort </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>relationship_subtypes <span class="ot">&lt;-</span> mc3_nodes_raw <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Relationship"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_type =</span> <span class="fu">factor</span>(sub_type, <span class="at">levels =</span> sub_type))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Plot</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(relationship_subtypes, <span class="fu">aes</span>(<span class="at">x =</span> sub_type, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"navy"</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Relationship Subtype"</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Relationship Subtypes"</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_edges_raw,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"navyblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter for type == "sent"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>filtered_edges <span class="ot">&lt;-</span> mc3_edges_raw <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">factor</span>(source, <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(source))))  <span class="co"># descending </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Plot</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_edges, <span class="fu">aes</span>(<span class="at">x =</span> source, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"navy"</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of 'sent' Edges type by Source"</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Source"</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> mc3_nodes_raw <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected, <span class="sc">-</span>time, <span class="sc">-</span>date, <span class="sc">-</span>friendship_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges_raw <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id), as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parse to_id to get supertype and sub_type for target nodes (e.g., Event_Communication)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(to_id, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"to_id_supertype"</span>, <span class="st">"to_id_sub_type"</span>, <span class="st">"to_id_num"</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"right"</span>, <span class="at">extra =</span> <span class="st">"merge"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter to ensure from_id and to_id exist in mc3_nodes_cleaned (prevent orphaned edges)</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Columns in mc3_edges_cleaned after initial cleaning:"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(mc3_edges_cleaned))</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Head of mc3_edges_cleaned after initial cleaning:"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(mc3_edges_cleaned))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the number of unique types in each column</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>unique_counts <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(n_distinct) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"column"</span>, <span class="at">values_to =</span> <span class="st">"unique_count"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the unique counts for each column</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(unique_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>node_index_lookup <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, .row_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_indexed <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out edges where either source or target node was not found</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to)) <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select all columns to carry forward to mc3_edges_final</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, id, is_inferred, type, <span class="co"># Original edge attributes</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>         from_id, to_id, to_id_supertype, to_id_sub_type, to_id_num <span class="co"># Original IDs and parsed target type</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>used_node_indices <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(mc3_edges_indexed<span class="sc">$</span>from, mc3_edges_indexed<span class="sc">$</span>to)))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(used_node_indices) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_index =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>old_to_new_index <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_index =</span> used_node_indices,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_index =</span> <span class="fu">seq_along</span>(used_node_indices)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_final <span class="ot">&lt;-</span> mc3_edges_indexed <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Explicitly select all columns that are needed downstream</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>         id, is_inferred, type,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>         from_id, to_id, to_id_supertype, to_id_sub_type, to_id_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> mc3_nodes_final,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> mc3_edges_final,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 1. Define styles and legends ----</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>event_subtypes <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Communication"</span>, <span class="st">"Monitoring"</span>, <span class="st">"VesselMovement"</span>, <span class="st">"Assessment"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Collaborate"</span>, <span class="st">"Endorsement"</span>, <span class="st">"TourActivity"</span>, <span class="st">"TransponderPing"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Harbor Report"</span>, <span class="st">"Fishing"</span>, <span class="st">"Criticize"</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>relationship_subtypes <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coordinates"</span>, <span class="st">"AccessPermission"</span>, <span class="st">"Operates"</span>, <span class="st">"Colleagues"</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Suspicious"</span>, <span class="st">"Reports"</span>, <span class="st">"Jurisdiction"</span>, <span class="st">"Unfriendly"</span>, <span class="st">"Friends"</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>node_legend_colors_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"#88CCEE"</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"#117733"</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"#AA4499"</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Group"</span><span class="ot">=</span> <span class="st">"#CC79A7"</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event"</span> <span class="ot">=</span> <span class="st">"#DDCC77"</span>,         <span class="co"># type level</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relationship"</span> <span class="ot">=</span> <span class="st">"#AF8DC3"</span>   <span class="co"># type level</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>node_legend_shapes_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"dot"</span>,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"triangle"</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"square"</span>,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"diamond"</span>,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Group"</span> <span class="ot">=</span> <span class="st">"circle plus"</span>,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event"</span> <span class="ot">=</span> <span class="st">"star"</span>,              <span class="co"># type level</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relationship"</span> <span class="ot">=</span> <span class="st">"square x"</span>    <span class="co"># type level</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>STYLES <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">node_label_dark =</span> <span class="st">"black"</span>,</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">font_family =</span> <span class="st">"Roboto Condensed"</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 2. Prepare nodes ----</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(name), id, name),</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># These parts are for pulling the related data from other fields</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip_extra =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Communication"</span> <span class="sc">~</span> content,</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Monitoring"</span> <span class="sc">~</span> findings,</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"VesselMovement"</span> <span class="sc">~</span> destination,</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Assessment"</span> <span class="sc">~</span> results,</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Relationship"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Coordinates"</span> <span class="sc">~</span> coordination_type,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Relationship"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Operates"</span> <span class="sc">~</span> operational_role,</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Relationship"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Jurisdiction"</span> <span class="sc">~</span> jurisdiction_type,</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;"</span>, label, <span class="st">"&lt;/b&gt;&lt;br&gt;"</span>,</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Type: "</span>, type, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sub-type: "</span>, sub_type, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(tooltip_extra), <span class="fu">paste0</span>(<span class="st">"&lt;br&gt;&lt;b&gt;Details:&lt;/b&gt; "</span>, tooltip_extra), <span class="st">""</span>)</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fallback logic: if sub_type is NA or not in styling list, use type instead</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">ifelse</span>(sub_type <span class="sc">%in%</span> <span class="fu">names</span>(node_legend_colors_plot), sub_type, type)</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, group, title) <span class="sc">%&gt;%</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 3. Prepare directed edges (type == "sent") ----</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> nodes<span class="sc">$</span>id <span class="sc">&amp;</span> to_id <span class="sc">%in%</span> nodes<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_id, <span class="at">to =</span> to_id)</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 4. Build visNetwork ----</span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes, edges, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"600px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="fu">list</span>(<span class="at">to =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, <span class="at">scaleFactor =</span> <span class="fl">1.5</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">font =</span> <span class="fu">list</span>(</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> STYLES<span class="sc">$</span>node_label_dark,</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">face =</span> STYLES<span class="sc">$</span>font_family,</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">vadjust =</span> <span class="sc">-</span><span class="dv">15</span></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 5. Apply shape and color per group ----</span></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (group_name <span class="cf">in</span> <span class="fu">names</span>(node_legend_colors_plot)) {</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>  net <span class="ot">&lt;-</span> net <span class="sc">%&gt;%</span> <span class="fu">visGroups</span>(</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">groupname =</span> group_name,</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> node_legend_colors_plot[[group_name]],</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> node_legend_shapes_plot[[group_name]]</span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 6. Add legend ----</span></span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>used_groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(nodes<span class="sc">$</span>group)</span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>legend_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> used_groups,</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> node_legend_shapes_plot[used_groups],</span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> node_legend_colors_plot[used_groups]</span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(label, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)  <span class="co"># remove duplicates just in case</span></span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> net <span class="sc">%&gt;%</span> <span class="fu">visLegend</span>(</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">addNodes =</span> legend_df,</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,                         <span class="co"># number of columns</span></span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">position =</span> <span class="st">"left"</span>,              </span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Entity (Sub)Types"</span>,      <span class="co"># title</span></span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">useGroups =</span> <span class="cn">FALSE</span>                <span class="co"># show custom legend entries</span></span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 7. Render ----</span></span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>net</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the 'from_id' column</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(from_id, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"from_id_supertype"</span>, <span class="st">"from_id_sub_type"</span>, <span class="st">"from_id_id"</span>), <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>, <span class="at">extra =</span> <span class="st">"drop"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the 'target' column into </span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(to_id, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"to_id_supertype"</span>, <span class="st">"to_id_sub_type"</span>,<span class="st">"to_id_id"</span>), <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>, <span class="at">extra =</span> <span class="st">"drop"</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the number of unique types in each column</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>unique_counts <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(n_distinct) <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"column"</span>, <span class="at">values_to =</span> <span class="st">"unique_count"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the unique counts for each column</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(unique_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the mapping</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from_id_supertype, from_id_sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the mapping</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(to_id_supertype, to_id_sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for duplicates</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>duplicate_values1 <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(content) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View duplicates</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(duplicate_values1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="tackling-question-1" class="level1">
<h1>** Tackling Question 1**</h1>
<section id="static-chord-diagram--all-communicators" class="level3">
<h3 class="anchored" data-anchor-id="static-chord-diagram--all-communicators">1.1.1 Static Chord Diagram- All Communicators</h3>
<p><strong>Findings:</strong></p>
<p>The thickness of each ribbon (chord) represents the magnitude of the relationship. A thicker ribbon represents more frequent communications (sent + received) between a sender and recipient.</p>
<p>Here, we have an overview of paired communicators who have higher frequencies. We also can see the links between communicators. These are the entities who communicated frequently with others that we might want to focus on:</p>
<ul>
<li><p>Person: The Intern, The Lookout, Clepper Jensen, Davis, Miranda Jordan, Mrs.&nbsp;Money.</p></li>
<li><p>Organization: Oceanus City Council, Green Guardian</p></li>
<li><p>Vessel: Reef Guardian, Neptune, Mako, Remora</p></li>
<li><p>Location: Himark Habor</p></li>
<li><p>Group: N/A</p></li>
</ul>
</section>
<section id="interactive-chord-diagram-by-community" class="level3">
<h3 class="anchored" data-anchor-id="interactive-chord-diagram-by-community">1.1.2 Interactive Chord Diagram by Community</h3>
<p>Here, the interactive chord diagram showed the correspondences among communities at every two hour intervals.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get community membership from graph object</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>community_df <span class="ot">&lt;-</span> g <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, community)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="no-code-fold">

</div>
<section id="findings" class="level4">
<h4 class="anchored" data-anchor-id="findings">1.1.2 Findings:</h4>
<p>We noticed some cross community direct and indirect communication occured mainly among influential nodes, suggesting collaboration. These are <strong>some</strong> sample linkages with arrows regardless of sent or received:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Community X</th>
<th>Node Linkages (Community X -&gt; Community X -&gt; Community Y)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Suspicious Characters</td>
<td><p>Mrs.&nbsp;Money -&gt; Intern -&gt; The Lookout</p>
<p>Liam -&gt; Paackland Harbor -&gt; The Middleman</p>
<p>Glitters Team -&gt; Boss -&gt; Mako</p>
<p>Glitters Team -&gt; Samantha Blake -&gt; Sailor Shifts Team</p></td>
</tr>
<tr class="even">
<td>Sailor Shift</td>
<td><p>Neptune -&gt; Elise -&gt; Mako</p>
<p>Neptune -&gt; Davis -&gt; Mako</p>
<p>Remora -&gt; Neptune -&gt; Boss</p>
<p>Rodriguez -&gt; Remora -&gt; Mako</p>
<p>Remora -&gt; Small Fry -&gt; Mako</p>
<p>Davis -&gt; Remora -&gt; Paackland Harbor</p>
<p>V. Miesel Shipping -&gt; Neptune -&gt; Mako</p></td>
</tr>
<tr class="odd">
<td>Sam &amp; Kelly</td>
<td>Kelly -&gt; Sam - &gt; The Lookout</td>
</tr>
<tr class="even">
<td>Maritime</td>
<td>Mako -&gt; Himark Harbor -&gt; Oceanus City Council</td>
</tr>
<tr class="odd">
<td>Hacklee Herald</td>
<td>N/A (Only Direct Community X to X communications)</td>
</tr>
<tr class="even">
<td>Conservationist Group</td>
<td><p>Reef Guardian -&gt; Oceanus City Council -&gt; Nadia</p>
<p>Reef Guardian -&gt; Paackland Harbor -&gt; Mako</p>
<p>Oceanus City Council -&gt; Liam -&gt; Nadia</p></td>
</tr>
</tbody>
</table>
<p>We also noticed that at times, certain individuals sent messages but there were no response back. This could possibly be due to the pseudonyms being used to send or reply to the same content. For instance, there was a message from Davis to Rodriguez on 14 Oct around 1200-1400 but there was no response by Rodriguez. By looking at the content field, we then found out that he was Small Fry due to the responses he provided to Davis which was originally addressed to Rodriguez.</p>
</section>
</section>
<section id="heatmap-of-correspondences" class="level3">
<h3 class="anchored" data-anchor-id="heatmap-of-correspondences">1.1.3 Heatmap of Correspondences</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Heatmap of Correspondences</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">

</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Count interactions</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">&lt;-</span> other_communications_df <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_name, recipient_name, <span class="at">name =</span> <span class="st">"count"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Compute total sent and received counts</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>sender_order <span class="ot">&lt;-</span> adj_df <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sender_name) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_sent =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_sent)) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sender_name)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>recipient_order <span class="ot">&lt;-</span> adj_df <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(recipient_name) <span class="sc">%&gt;%</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_received =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_received)) <span class="sc">%&gt;%</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(recipient_name)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Reorder factor levels</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">&lt;-</span> adj_df <span class="sc">%&gt;%</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_name =</span> <span class="fu">factor</span>(sender_name, <span class="at">levels =</span> sender_order),</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">recipient_name =</span> <span class="fu">factor</span>(recipient_name, <span class="at">levels =</span> recipient_order)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Plot heatmap</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adj_df, <span class="fu">aes</span>(<span class="at">x =</span> recipient_name, <span class="at">y =</span> sender_name, <span class="at">fill =</span> count)) <span class="sc">+</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"navyblue"</span>) <span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Sender-Recipient Communication Heatmap"</span>,</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Top communicators sorted to bottom-left"</span>,</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Recipient"</span>,</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sender"</span>,</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Messages"</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>Findings:</strong></p>
<p>After extraction of the entities who communicated frequently (from the Static Chord Diagram), we tabled who they communicated with by using the heatmap. E.g. Name1 communicated with Name2.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="header">
<th>Name 1 Subtype</th>
<th>Name1</th>
<th>Name2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Person</td>
<td>The Intern</td>
<td>The Lookout, Mrs.&nbsp;Money</td>
</tr>
<tr class="even">
<td>Person</td>
<td>Clepper Jensen</td>
<td>Miranda Jordan</td>
</tr>
<tr class="odd">
<td>Person</td>
<td>Davis</td>
<td>Neptune</td>
</tr>
<tr class="even">
<td>Person</td>
<td>Mrs.&nbsp;Money</td>
<td>The Intern, The Middleman, Boss</td>
</tr>
<tr class="odd">
<td>Vessel</td>
<td>Mako</td>
<td>Remora, Green Guardians, Oceanus City Council, Neptune, Reef Guardians, Himark Harbor, Davis, Sentinel, Paackland Habor, Samantha Blake, Serenity, Osprey</td>
</tr>
<tr class="even">
<td>Vessel</td>
<td>Remora</td>
<td>Mako, Neptune, Himark Habor, Davis, Paackland Harbor, V. Miesel Shipping, Marlin, Small Fry</td>
</tr>
<tr class="odd">
<td>Vessel</td>
<td>Neptune</td>
<td>Mako, Himark Habor, Remora, Mrs Money, V. Miesel Shipping, Nadia, Serenity</td>
</tr>
<tr class="even">
<td>Vessel</td>
<td>Reef Guardian</td>
<td>Green Guardians, Oceanus City Council, Mako, Paackland Harbor, EcoVigil, Serenity, Defender</td>
</tr>
<tr class="odd">
<td>Organization</td>
<td>Green Guardian</td>
<td>Green Guardians, Oceanus City Council, The Lookout, Sentinel, Horizon</td>
</tr>
<tr class="even">
<td>Organization</td>
<td>Oceanus City Council</td>
<td>Green Guardians, Reef Guardians, Himark Harbor, Sentinel, Paackland Harbor, Liam Thorne, Samantha Blake, Haacklee Harbor</td>
</tr>
<tr class="odd">
<td>Location</td>
<td>Himark Habor</td>
<td>Oceanus City Council, Mako, Serenity, Marlin</td>
</tr>
</tbody>
</table>
</section>
<section id="heatmap-of-date-and-hours" class="level3">
<h3 class="anchored" data-anchor-id="heatmap-of-date-and-hours">1.1.4 Heatmap of date and hours</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Heatmap of date and hours</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">The code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>MC3_graph <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_graph.json"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>nodes_tbl  <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3_graph<span class="sc">$</span>nodes)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>edges_tbl  <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3_graph<span class="sc">$</span>edges)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only the communication events</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>comm_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> id, timestamp)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull out who sent and who received each message</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>sent_edges <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">sender =</span> source, <span class="at">event_id =</span> target)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>recv_edges <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> source, <span class="at">receiver =</span> target)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  Join everything together and parse the timestamp</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>msgs <span class="ot">&lt;-</span> sent_edges <span class="sc">%&gt;%</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(recv_edges, <span class="at">by =</span> <span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(comm_nodes, <span class="at">by =</span> <span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ts   =</span> <span class="fu">ymd_hms</span>(timestamp, <span class="at">tz =</span> <span class="st">"UTC"</span>),</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as_date</span>(ts),</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="fu">hour</span>(ts)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a complete dateÃ—hour grid, filling in zeros where needed</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(date, hour) <span class="sc">%&gt;%</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">seq</span>(<span class="fu">min</span>(date), <span class="fu">max</span>(date), <span class="at">by =</span> <span class="st">"1 day"</span>),</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>,</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">0</span>)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the heatmap</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heatmap_data, <span class="fu">aes</span>(<span class="at">x =</span> hour, <span class="at">y =</span> date, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>,</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_date</span>(</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks      =</span> <span class="fu">seq</span>(<span class="fu">min</span>(heatmap_data<span class="sc">$</span>date), <span class="fu">max</span>(heatmap_data<span class="sc">$</span>date), <span class="at">by =</span> <span class="st">"1 day"</span>),</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%b %d"</span>,</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand      =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">name    =</span> <span class="st">"Messages"</span>,</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="dv">1</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Daily Communication Patterns"</span>,</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Hour of Day"</span>,</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Date"</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid  =</span> <span class="fu">element_blank</span>()</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>```r, echo=TRUE, message=FALSE, warning=FALSE</p>
<section id="load-data" class="level1">
<h1>Load data</h1>
<p>MC3_graph &lt;- fromJSON(â€œdata/MC3_graph.jsonâ€) nodes_tbl &lt;- as_tibble(MC3_graph<span class="math inline">\(nodes)
edges_tbl  &lt;- as_tibble(MC3_graph\)</span>edges)</p>
</section>
<section id="extract-only-the-communication-events" class="level1">
<h1>Extract only the communication events</h1>
<p>comm_nodes &lt;- nodes_tbl %&gt;% filter(type == â€œEventâ€, sub_type == â€œCommunicationâ€) %&gt;% select(event_id = id, timestamp)</p>
</section>
<section id="pull-out-who-sent-and-who-received-each-message" class="level1">
<h1>Pull out who sent and who received each message</h1>
<p>sent_edges &lt;- edges_tbl %&gt;% filter(type == â€œsentâ€) %&gt;% select(sender = source, event_id = target)</p>
<p>recv_edges &lt;- edges_tbl %&gt;% filter(type == â€œreceivedâ€) %&gt;% select(event_id = source, receiver = target)</p>
</section>
<section id="join-everything-together-and-parse-the-timestamp" class="level1">
<h1>Join everything together and parse the timestamp</h1>
<p>msgs &lt;- sent_edges %&gt;% inner_join(recv_edges, by = â€œevent_idâ€) %&gt;% inner_join(comm_nodes, by = â€œevent_idâ€) %&gt;% mutate( ts = ymd_hms(timestamp, tz = â€œUTCâ€), date = as_date(ts), hour = hour(ts) )</p>
</section>
<section id="build-a-complete-datehour-grid-filling-in-zeros-where-needed" class="level1">
<h1>Build a complete dateÃ—hour grid, filling in zeros where needed</h1>
<p>heatmap_data &lt;- msgs %&gt;% count(date, hour) %&gt;% complete( date = seq(min(date), max(date), by = â€œ1 dayâ€), hour = 0:23, fill = list(n = 0) )</p>
<p>#Plot the heatmap ggplot(heatmap_data, aes(x = hour, y = date, fill = n)) + geom_tile(color = â€œwhiteâ€) + scale_x_continuous( breaks = 0:23, expand = c(0, 0) ) + scale_y_date( breaks = seq(min(heatmap_data<span class="math inline">\(date), max(heatmap_data\)</span>date), by = â€œ1 dayâ€), date_labels = â€œ%b %dâ€, expand = c(0, 0) ) + scale_fill_distiller( name = â€œMessagesâ€, palette = â€œSpectralâ€, direction = 1 ) + labs( title = â€œDaily Communication Patternsâ€, x = â€œHour of Dayâ€, y = â€œDateâ€ ) + theme_minimal() + theme( axis.text.x = element_text(hjust = 0.5), axis.text.y = element_text(size = 8), panel.grid = element_blank() )</p>
<pre><code>:::

### 1.1.5 Hourly Communication Patterns: Week 1 vs Week 2
::: panel-tabset
## Compare the communication pattern


::: {.cell}

```{.r .cell-code}
msgs &lt;- msgs %&gt;%
  mutate(
    week = if_else(date &lt;= min(date) + days(6), "Week 1", "Week 2")
  )
# Count and normalize within each week
week_patterns &lt;- msgs %&gt;%
  count(week, hour) %&gt;%
  group_by(week) %&gt;%
  mutate(proportion = n / sum(n))


hour_breaks &lt;- seq(min(week_patterns$hour), max(week_patterns$hour), by = 1)
prop_breaks &lt;- seq(
  0,
  ceiling(max(week_patterns$proportion) * 100) / 100,
  by = 0.02
)

ggplot(week_patterns, aes(x = hour, y = proportion, color = week)) +
  geom_line(size = 1.2) +
  geom_point(size = 3) +
  scale_x_continuous(breaks = hour_breaks) +
  scale_y_continuous(
    breaks = prop_breaks,
    labels = percent_format(accuracy = 1)
  ) +
  labs(
    title = "Hourly Communication Patterns: Week 1 vs Week 2",
    x     = "Hour of Day",
    y     = "Percent of Total Messages"
  ) +
  theme_light(base_size = 12) +
  theme(
    plot.title      = element_text(face = "bold", size = 16, hjust = 0.5),
    legend.position = "top",
    legend.title    = element_blank(),
    panel.grid.major = element_line(color = "grey80"),
    panel.grid.minor = element_line(color = "grey90"),
    axis.text.x     = element_text(vjust = 0.5),
    axis.text.y     = element_text(size = 8)
  )</code></pre>
</section>
</div>
</div>
</div>
</section>
<section id="the-code-2" class="level2">
<h2 class="anchored" data-anchor-id="the-code-2">The code</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>msgs <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">week =</span> <span class="fu">if_else</span>(date <span class="sc">&lt;=</span> <span class="fu">min</span>(date) <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">6</span>), <span class="st">"Week 1"</span>, <span class="st">"Week 2"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Count and normalize within each week</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>week_patterns <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(week, hour) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(week) <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>hour_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(week_patterns<span class="sc">$</span>hour), <span class="fu">max</span>(week_patterns<span class="sc">$</span>hour), <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>prop_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ceiling</span>(<span class="fu">max</span>(week_patterns<span class="sc">$</span>proportion) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fl">0.02</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(week_patterns, <span class="fu">aes</span>(<span class="at">x =</span> hour, <span class="at">y =</span> proportion, <span class="at">color =</span> week)) <span class="sc">+</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> hour_breaks) <span class="sc">+</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> prop_breaks,</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Hourly Communication Patterns: Week 1 vs Week 2"</span>,</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Hour of Day"</span>,</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Percent of Total Messages"</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title    =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey80"</span>),</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>),</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x     =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The visualization of hourly communication patterns reveals that message activity in Oceanus follows a pronounced daily cycle, with distinct peaks and lows across both observed weeks.</p>
<p>In Week 1, communication is highly concentrated in the morning hours, particularly between 8 AM and 12 PM, where a majority of the messages are exchanged.</p>
<p>By contrast, Week 2 shows a broader distribution of communication throughout the day, with notable increases in afternoon and evening activity.</p>
<p>This shift suggests that while the first weekâ€™s communications were more focused and possibly related to regular planning or operational updates, the second weekâ€™s patterns reflect heightened activity or more dynamic coordination, potentially due to emergent events or increased urgency among entities.</p>
</div>
</div>
</section>
</section>
<section id="tackling-question-2" class="level1">
<h1><strong>Tackling Question 2</strong></h1>
</section>
<section id="question-2a" class="level1">
<h1>Question 2a)</h1>
<section id="unique-count-from-each-sender-subtype" class="level3">
<h3 class="anchored" data-anchor-id="unique-count-from-each-sender-subtype">2.1.1 Unique count from each sender subtype</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Unique Count</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">

</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sender_names_by_type <span class="ot">&lt;-</span> other_communications_df <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sender_sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">unique_senders =</span> <span class="fu">n_distinct</span>(sender_name),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_names =</span> <span class="fu">paste</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(sender_name)), <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(unique_senders))  <span class="co"># sort from largest to smallest</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View the table</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sender_names_by_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>There were no Group sub-type as confirmed by this filtered table.</p>
</div>
</div>
</div>
</section>
<section id="people-and-vessels" class="level2">
<h2 class="anchored" data-anchor-id="people-and-vessels">2.2 People and Vessels</h2>
<p>Due to a large number of entity subtypes as people and vessels in 7.1.4, we then looked into the charactersâ€™ and vesselâ€™s identity and their actual communication content.</p>
<section id="filter-by-vessel-and-person-only" class="level3">
<h3 class="anchored" data-anchor-id="filter-by-vessel-and-person-only">2.2.1 Filter by Vessel and Person only</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>person_vessel_df <span class="ot">&lt;-</span> other_communications_df <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    (sender_sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">&amp;</span> recipient_sub_type <span class="sc">==</span> <span class="st">"Vessel"</span>) <span class="sc">|</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    (sender_sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">&amp;</span> recipient_sub_type <span class="sc">==</span> <span class="st">"Person"</span>) <span class="sc">|</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    (sender_sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">&amp;</span> recipient_sub_type <span class="sc">==</span> <span class="st">"Person"</span>) <span class="sc">|</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    (sender_sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">&amp;</span> recipient_sub_type <span class="sc">==</span> <span class="st">"Vessel"</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="plotted-timeline--people-vessels" class="level3">
<h3 class="anchored" data-anchor-id="plotted-timeline--people-vessels">2.2.2 Plotted Timeline- People &amp; Vessels</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- FACTORING and DATETIME CLEANING ---</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>person_vessel_df_for_plot <span class="ot">&lt;-</span> person_vessel_df <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">as.POSIXct</span>(timestamp),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_date =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_time_of_day =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">format</span>(timestamp, <span class="st">"%H:%M:%S"</span>)),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_sub_type =</span> <span class="fu">factor</span>(sender_sub_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">communicating_pair_sorted =</span> <span class="fu">paste</span>(<span class="fu">pmin</span>(sender_name, recipient_name), <span class="fu">pmax</span>(sender_name, recipient_name), <span class="at">sep =</span> <span class="st">" &amp; "</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- WRAPPING CONTENT AND TOOLTIP ---</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>plot_data1 <span class="ot">&lt;-</span> person_vessel_df_for_plot <span class="sc">%&gt;%</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">as.POSIXct</span>(timestamp),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">format</span>(timestamp, <span class="st">"%H:%M:%S"</span>),</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">wrapped_content =</span> <span class="fu">str_wrap</span>(content, <span class="at">width =</span> <span class="dv">50</span>),</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip_text =</span> <span class="fu">paste0</span>(</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Date:&lt;/b&gt; "</span>, date, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Time:&lt;/b&gt; "</span>, time, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;From:&lt;/b&gt; "</span>, sender_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;To:&lt;/b&gt; "</span>, recipient_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Event_id:&lt;/b&gt; "</span>, event_id, <span class="st">"&lt;br&gt;&lt;br&gt;"</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Content:&lt;/b&gt;&lt;br&gt;"</span>, wrapped_content</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span><span class="fu">ggplot</span>(plot_data1, <span class="fu">aes</span>(<span class="at">x =</span> comm_date, <span class="at">y =</span> comm_time_of_day)) <span class="sc">+</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> sender_id,</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> sender_sub_type,</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> tooltip_text</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  ),<span class="at">show.legend =</span> <span class="fu">c</span>(<span class="at">color =</span> <span class="cn">TRUE</span>, <span class="at">shape =</span> <span class="cn">FALSE</span>), </span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Person"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sender_sub_type, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"fixed"</span>) <span class="sc">+</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_time</span>(</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"14:00:00"</span>)),  <span class="co"># reversed to show time top-to-bottom</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"09:00:00"</span>, <span class="st">"10:00:00"</span>, <span class="st">"11:00:00"</span>, <span class="st">"12:00:00"</span>, <span class="st">"13:00:00"</span>, <span class="st">"14:00:00"</span>)),</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"08:00"</span>, <span class="st">"09:00"</span>, <span class="st">"10:00"</span>, <span class="st">"11:00"</span>, <span class="st">"12:00"</span>, <span class="st">"13:00"</span>, <span class="st">"14:00"</span>)</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_breaks =</span> <span class="st">"1 day"</span>,</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_labels =</span> <span class="st">"%d %b"</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Communication Events Over Time (Sender's Perspective)"</span>,</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Sender (subtype, name)"</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">8</span>), <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),  <span class="co"># Applies to both x and y spacing</span></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Convert to interactive plot ---</span></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"tooltip_text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="findings-on-people-vessels" class="level4">
<h4 class="anchored" data-anchor-id="findings-on-people-vessels">2.2.2.1 Findings on People/ Vessels:</h4>
<ul>
<li><p>Core logic:</p>
<ul>
<li><p>If two names appear as sender and recipient in the same message, they cannot belong to the same person â€” i.e., theyâ€™re not aliases of each other.</p></li>
<li><p>If two names sent a message at the exact time, they cannot belong to the same person.</p></li>
<li><p>For instance, if Nadia sent a message to The Accountant, they would not be the same individual. If Nadia sent a message at 10am to The Accountant and The Lookout also sent a message at 10am to The Intern, Nadia and The Lookout cannot be the same person.</p></li>
</ul></li>
<li><p>Select only The Accountant, Mrs.&nbsp;Money, Elise: We see close timings between Mrs.&nbsp;Money and Elise on 8 Oct, and 10 Oct.&nbsp;These were on the same topic. Elise then disappears from radar on 10 Oct.&nbsp;She reappears as The Accountant and Mrs.&nbsp;Money on 11 Oct on the same topic and remains only as The Accountant till 14 Oct.</p></li>
<li><p>Select only Liam and The Middleman: The Middleman disappeared on 7 Oct and appeared as Liam on 8 Oct.&nbsp;On 11 Oct Mrs.&nbsp;Money asked The Middleman if anything was found by conservation vessels. On the same day, Liam reappeared and replied Elise that nothing was found by them.</p></li>
<li><p>Select only The Boss and Nadia: The Boss disappeared on 5 Oct and reappeared as Nadia on 8 Oct.&nbsp;Likely the same person.</p></li>
<li><p>Select only Small Fry and Rodriguez: on 2 Oct Rodriguez corresponded with Remora and Mako on meeting at the slip #14. It happened again on 14 Oct as he took on dual roles and responded to the same message with different names. Likely the same person.</p></li>
<li><p>Select only The Lookout and Sam: on 7 Oct Sam asked Kelly to get information on who authorized the permit. 2 minutes later, The Lookout (Kelly) responded to The Intern (Sam), that it was signed by Jensen from City Council.</p></li>
<li><p>Seawatch only appeared on 10 Oct but Horizon talked to Seawatch on 8 Oct.&nbsp;Therefore, some other entity is Seawatch before or during 8 Oct.&nbsp;Defender told Seawatch on 3 Oct at 8.39am that it increased its patrol and informed Seawatch to maintain vigilance. The Lookout (Seawatch) responded to Sentinel (Defender) at 8.41am that it acknowledged the need for vigilance.</p></li>
<li><p>After getting a general idea of the charactersâ€™ involvement, we looked at the interactions in 7.3.</p></li>
</ul>
</section>
</section>
<section id="suspicious-conversations" class="level3">
<h3 class="anchored" data-anchor-id="suspicious-conversations">2.3.1 Suspicious Conversations</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr) <span class="co"># For separate_rows, if needed for 'Event Id' later</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame using tribble, consolidating multi-line entries</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>df_new_data <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Sender, <span class="sc">~</span>Recipient, <span class="sc">~</span>Commonalities, <span class="sc">~</span>Rationale, <span class="sc">~</span>Suspicious_Status, <span class="sc">~</span>Date, <span class="sc">~</span>Event_Id,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The Lookout (Person)"</span>, <span class="st">"The Intern (Person)"</span>, <span class="st">"Mako"</span>, <span class="st">"Jensen from City Council signed a permit to set a corridor for Mako vessel."</span>, <span class="st">"Jensen"</span>, <span class="st">"5/10"</span>, <span class="st">"371"</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Glitters Team aka. Sailor Shift Team"</span>, <span class="st">"Boss (Person)"</span>, <span class="st">"Permit, Commissioner Torres"</span>, <span class="st">"Glitters thanked their Boss who got Commissioner Torres to sign off the permit"</span>, <span class="st">"Nadia aka The Boss"</span>, <span class="st">"6/10"</span>, <span class="st">"389"</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Remora (Vessel)"</span>, <span class="st">"Sailor Shift Team aka. Glitters Team"</span>, <span class="st">"Permit, Commissioner Torres"</span>, <span class="st">"Davis thanked Nadia who got Commissioner Torres to sign off the permit"</span>, <span class="st">"Nadia aka The Boss"</span>, <span class="st">"6/10"</span>, <span class="st">"388"</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mrs. Money (Person)"</span>, <span class="st">"Mako (Vessel); Neptune (Vessel)"</span>, <span class="st">"Mako, Remora, Neptune"</span>, <span class="st">"Mrs. Money is the Financial Controller who provides the payment protocols for Mako and Remora's captions. She also provides the encryption protocols and transfer devices. Mrs. Money coordinates payment protocols for Remora and Mako captains"</span>, <span class="st">"Elise aka. Mrs. Money"</span>, <span class="st">"7/10"</span>, <span class="st">"458 and 464"</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Neptune/ Neptune Captain"</span>, <span class="st">"Elise aka. Mrs. Money (Person)"</span>, <span class="st">"Remora, Mako"</span>, <span class="st">"Neptune told her to coordinate payment protocols for Remora and Mako captains"</span>, <span class="st">"Elise aka. Mrs. Money"</span>, <span class="st">"7/10"</span>, <span class="st">"456 and 518"</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Remona (Vessel)"</span>, <span class="st">"Rodriquez (Person)"</span>, <span class="st">"Sailor Shift"</span>, <span class="st">"Nemo Reef selected for Sailor Shift's music shoot.; Nadia personally handled permits for Nemo Reefs after meeting Davis."</span>, <span class="st">"Both"</span>, <span class="st">"2/10"</span>, <span class="st">"153 and 328"</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Remona (Vessel)"</span>, <span class="st">"Nadia (Person)"</span>, <span class="st">"Delta 3, Sailor Shift"</span>, <span class="st">"Tourism facade created by Remona and awaiting installation of underwater lighting placements at Nemo Reef."</span>, <span class="st">"Both"</span>, <span class="st">"14/10"</span>, <span class="st">"943"</span>,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Davis (Person)"</span>, <span class="st">"Mako (Vessel)"</span>, <span class="st">"Rodriquez, Nadia, Neptune"</span>, <span class="st">"Rodriquez will help with logistics."</span>, <span class="st">"Both"</span>, <span class="st">"2/10"</span>, <span class="st">"115"</span>,</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Davis (Person)"</span>, <span class="st">"Mako (Vessel)"</span>, <span class="st">"Rodriquez, Nadia, Neptune"</span>, <span class="st">"V. Miesel's Marine Research Permit is CR-7844. There is a 5 day deadline from 8 Oct."</span>, <span class="st">"Both"</span>, <span class="st">"8/10"</span>, <span class="st">"548"</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Davis (Person)"</span>, <span class="st">"Mako (Vessel)"</span>, <span class="st">"Rodriquez, Nadia, Neptune"</span>, <span class="st">"V. Miesel approved their operational authority."</span>, <span class="st">"Both"</span>, <span class="st">"12/10"</span>, <span class="st">"802"</span>,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Davis (Person)"</span>, <span class="st">"Remona (Vessel)"</span>, <span class="st">"Client"</span>, <span class="st">"Davis wants to maintain client's privacy with Paackland Harbour."</span>, <span class="st">"Both, and also Paackland Harbour"</span>, <span class="st">"4/10"</span>, <span class="st">"282"</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mako (Vessel)"</span>, <span class="st">"Davis (Person)"</span>, <span class="st">"Permit CR-7844, Boss"</span>, <span class="st">"Davis is a captain."</span>, <span class="st">"Both"</span>, <span class="st">"5/10"</span>, <span class="st">"349"</span>,</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mako (Vessel)"</span>, <span class="st">"Boss (Person)"</span>, <span class="st">"Boss, Samantha"</span>, <span class="st">"Oceanus Council approved Mako's departure to Nemo Reef with minimal documentation."</span>, <span class="st">"Oceanus Council"</span>, <span class="st">"5/10"</span>, <span class="st">"365"</span>,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Boss (Person)"</span>, <span class="st">"Marko (Vessel)"</span>, <span class="st">"Mission, Boss"</span>, <span class="st">"Informed Marko to abort mission as conservation patrols are tracking it"</span>, <span class="st">"Both"</span>, <span class="st">"4/10"</span>, <span class="st">"316"</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small Fry aka Rodriquez (Person)"</span>, <span class="st">"Remora (Vessel, Mako (Vessel)"</span>, <span class="st">"Slip #14, Glitters Team, Sailor Team"</span>, <span class="st">"Mako asked Rodriquez when he could come by slip #14.; Small Fry replied he would come by slip #14 in 30 minutes time.; Small Fry surprised that Glitters Team filing for paperwork downtown for protected area of Nemo Reef."</span>, <span class="st">"Both"</span>, <span class="st">"2/10"</span>, <span class="st">"142, 143 and 156"</span>,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Neptune"</span>, <span class="st">"Nadia (Person); Neptune (Vessel)"</span>, <span class="st">"Equipment specs"</span>, <span class="st">"Neptune asked to meet Nadia at 0600 and confirm the equipment specs approved by Elise.; Nadia confirmed the time with Neptune and agreed to show her reviewed equipment specs from The Accountant."</span>, <span class="st">"Both; Elise aka The Accountant"</span>, <span class="st">"8/10"</span>, <span class="st">"537 and 738"</span>,</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Knowles (Vessel)"</span>, <span class="st">"Davis (Person)"</span>, <span class="st">"Boss"</span>, <span class="st">"Instructed by Mako to provide equipment transfer."</span>, <span class="st">"Both"</span>, <span class="st">"14/10"</span>, <span class="st">"1001 and 1003"</span>,</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sentinel(Vessel)"</span>, <span class="st">"Mako (Vessel)"</span>, <span class="st">"Permit"</span>, <span class="st">"Mako told Sentinel it was operating under NR-1045."</span>, <span class="st">"Mako"</span>, <span class="st">"7/10"</span>, <span class="st">"467"</span>,</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mako (Vessel)"</span>, <span class="st">"Sentinel (Vessel)"</span>, <span class="st">"Permit"</span>, <span class="st">"Sentinel asked the reasons for Mako operating under permit NR-1045"</span>, <span class="st">"Mako"</span>, <span class="st">"8/10"</span>, <span class="st">"574"</span>,</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mako (Vessel)"</span>, <span class="st">"Sentinel (Vessel)"</span>, <span class="st">"Permit"</span>, <span class="st">"Mako told Sentinel it was operating under permit CR-7844 (marine equipment transport) not NR-1045"</span>, <span class="st">"Mako"</span>, <span class="st">"8/10"</span>, <span class="st">"575"</span>,</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Miranda (Person)"</span>, <span class="st">"Clepper Jesen (Person)"</span>, <span class="st">"Rodriquez"</span>, <span class="st">"Rodriquez filed for permits under Sailor Shifts Team for 2 commercial and 1 private yatch to perform environmental sampling."</span>, <span class="st">"Rodriquez is suspicious. The communicators are not suspicious."</span>, <span class="st">"2/10"</span>, <span class="st">"130"</span>,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Miranda (Person)"</span>, <span class="st">"Clepper Jesen (Person)"</span>, <span class="st">"Rodriquez"</span>, <span class="st">"Rodriquez is connected to a mining consortium with previous violations in protected areas."</span>, <span class="st">"Rodriquez is suspicious. The communicators are not suspicious"</span>, <span class="st">"2/10"</span>, <span class="st">"134"</span>,</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Miranda (Person)"</span>, <span class="st">"Clepper Jesen (Person)"</span>, <span class="st">"Rodriquez"</span>, <span class="st">"Rodriquez is connected to Council Knowles and they are related to V. Miesel Shipping which is possibly a shell company which has vessels."</span>, <span class="st">"Rodriquez is suspicious. The communicators are not suspicious."</span>, <span class="st">"3/10"</span>, <span class="st">"201"</span>,</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Miranda (Person)"</span>, <span class="st">"Clepper Jesen (Person)"</span>, <span class="st">"Rodriquez is suspicious"</span>, <span class="st">"Council Knowles' brother-in-law owns the offshore bank account to V. Miesel Shipping. The company is involved in rare earth extraction."</span>, <span class="st">"Rodriquez is suspicious. The communicators are not suspicious."</span>, <span class="st">"3/10"</span>, <span class="st">"204"</span>,</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Miranda (Person)"</span>, <span class="st">"Clepper Jesen (Person)"</span>, <span class="st">"Rodriquez is suspicious"</span>, <span class="st">"Knowles accepted cash from Rodriquez."</span>, <span class="st">"Rodriquez is suspicious. The communicators are not suspicious."</span>, <span class="st">"3/10"</span>, <span class="st">"206"</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the data (primarily for consistent whitespace and Event_Id splitting if necessary)</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>df_processed <span class="ot">&lt;-</span> df_new_data <span class="sc">%&gt;%</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Standardize delimiters and remove excess whitespace across all character columns.</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span> <span class="fu">str_replace_all</span>(.x, <span class="st">"[,</span><span class="sc">\n</span><span class="st">]+"</span>, <span class="st">", "</span>) <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>())</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For Event_Id, replace "and" with comma and then separate rows if needed</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Event_Id =</span> <span class="fu">str_replace_all</span>(Event_Id, <span class="st">" and "</span>, <span class="st">", "</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), str_trim)) <span class="sc">%&gt;%</span></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Event_Id =</span> <span class="fu">as.character</span>(Event_Id)) <span class="co"># Ensure Event_Id is character</span></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the reactable table</span></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>  df_processed,</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">filterable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">paginationType =</span> <span class="st">"numbers"</span>,</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">5</span>,</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>),</span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sender =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sender"</span>, <span class="at">minWidth =</span> <span class="dv">120</span>),</span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">Recipient =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Recipient"</span>, <span class="at">minWidth =</span> <span class="dv">120</span>),</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Commonalities =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Commonalities"</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rationale =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Rationale"</span>, <span class="at">minWidth =</span> <span class="dv">300</span>),</span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rename Suspicious_Status for display</span></span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Suspicious_Status =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Suspicious?"</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Date column as text, no special date sorting</span></span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Date =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Date"</span>, <span class="at">minWidth =</span> <span class="dv">80</span>, <span class="at">align =</span> <span class="st">"center"</span>),</span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Event_Id =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Event Id"</span>, <span class="at">minWidth =</span> <span class="dv">80</span>, <span class="at">align =</span> <span class="st">"center"</span>)</span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#dfe2e5"</span>,</span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span>,</span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightColor =</span> <span class="st">"#f0f5f9"</span>,</span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">cellPadding =</span> <span class="st">"8px 12px"</span>,</span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontFamily =</span> <span class="st">"Verdana, Geneva, sans-serif"</span>, <span class="at">fontSize =</span> <span class="st">"14px"</span>),</span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;.rt-th:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">backgroundColor =</span> <span class="st">"#e0e6eb"</span>),</span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">fontSize =</span> <span class="st">"15px"</span>,</span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">fontWeight =</span> <span class="dv">600</span>,</span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"#333"</span>,</span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">background =</span> <span class="st">"#f7f7f7"</span></span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">rowSelectedStyle =</span> <span class="fu">list</span>(<span class="at">backgroundColor =</span> <span class="st">"#e6f2ff"</span>, <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">backgroundColor =</span> <span class="st">"#e6f2ff"</span>)),</span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchInputStyle =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">margin =</span> <span class="st">"5px 0"</span>, <span class="at">padding =</span> <span class="st">"5px"</span>),</span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">filterInputStyle =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">margin =</span> <span class="st">"2px 0"</span>, <span class="at">padding =</span> <span class="st">"4px"</span>)</span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="non-suspicious-conversations" class="level3">
<h3 class="anchored" data-anchor-id="non-suspicious-conversations">2.3.2 Non-suspicious conversations</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr) <span class="co"># For separate_rows</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># For date parsing</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Manually parse the data into a tribble</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Each row in the tribble corresponds to a logical entry from provided text.</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Multi-line strings within a cell are captured using '\n'.</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># The 'Suspicious?' column is named 'Suspicious_Status' in R to avoid special characters,</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and will be renamed in the reactable column definition for display.</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>df_raw_input <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Sender, <span class="sc">~</span>Recipient, <span class="sc">~</span>Commonalities, <span class="sc">~</span>Rationale, <span class="sc">~</span>Suspicious_Status, <span class="sc">~</span>Date, <span class="sc">~</span>Event_Id,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Samantha (Person)"</span>, <span class="st">"Sailor Shift Team aka Glitters Team (Organization)"</span>, <span class="st">"Permit, Nemo Reef, Music Video"</span>, <span class="st">"Samantha was assisting Sailor Shift Team to coordinate the permit and equipment rental for their music video and wanted confirmation on Nemo Reef as their intended location."</span>, <span class="st">"Unsure"</span>, <span class="st">"1/10"</span>, <span class="st">"64"</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sailor Shift Team aka Glitters Team (Organization)"</span>, <span class="st">"Samantha (Person)"</span>, <span class="st">"Permit, Nemo Reef,"</span>, <span class="st">"Glitters Team confirmed with Samantha that they would like to use Nemo Reef as their primary location"</span>, <span class="st">"Unsure"</span>, <span class="st">"1/10"</span>, <span class="st">"66"</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mako (Vessel)"</span>, <span class="st">"Samantha (Person)"</span>, <span class="st">"Nemo Reef Permit"</span>, <span class="st">"Mako claims that Samantha has a coordination team. Preparing for an event in a week's time from 6 Oct."</span>, <span class="st">"Samantha is not"</span>, <span class="st">"6/10"</span>, <span class="st">"380"</span>,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mako (Vessel)"</span>, <span class="st">"Samantha (Person)"</span>, <span class="st">"Nemo Reef Permit"</span>, <span class="st">"Samantha advised them to stop activities which might be illegal without permit"</span>, <span class="st">"Samantha is not"</span>, <span class="st">"10/10"</span>, <span class="st">"687"</span>,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The Lookout (Person)"</span>, <span class="st">"Sentinel (Vessel)"</span>, <span class="st">"Marina's Dream, Music Video"</span>, <span class="st">"Spotted 3 suspicious vessels around Nemo Reef on 3/10."</span>, <span class="st">"Both are not"</span>, <span class="st">"3/10"</span>, <span class="st">"171"</span>,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The Lookout (Person)"</span>, <span class="st">"Sentinel (Vessel)"</span>, <span class="st">"Marina's Dream, Music Video"</span>, <span class="st">"Spotted music video production on 13/10"</span>, <span class="st">"Both are not"</span>, <span class="st">"13/10"</span>, <span class="st">"912"</span>,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The Lookout (Person)"</span>, <span class="st">"Horizon (Vessel)"</span>, <span class="st">"Music Video"</span>, <span class="st">"Found it suspicious to spot lighting rigs and cameras at 12pm. Wanted Horizon to investigate"</span>, <span class="st">"Both are not"</span>, <span class="st">"13/10"</span>, <span class="st">"926"</span>,</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"EcoVigil (Vessel)"</span>, <span class="st">"Liam (Person)"</span>, <span class="st">"ROVs"</span>, <span class="st">"Collection of water samples using ROVs"</span>, <span class="st">"EcoVigil is not"</span>, <span class="st">"11/10"</span>, <span class="st">"737 and 751"</span> <span class="co"># "and" will be handled by separate_rows</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Process the data for display and sorting</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>df_processed <span class="ot">&lt;-</span> df_raw_input <span class="sc">%&gt;%</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Standardize delimiters and remove excess whitespace across all character columns.</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This flattens multi-line strings within cells and makes 'separate_rows' more reliable.</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span> <span class="fu">str_replace_all</span>(.x, <span class="st">"[,</span><span class="sc">\n</span><span class="st">]+"</span>, <span class="st">", "</span>) <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>())</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Handle the "and" in Event_Id, converting it to a comma for consistent splitting.</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Event_Id =</span> <span class="fu">str_replace_all</span>(Event_Id, <span class="st">" and "</span>, <span class="st">", "</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, use separate_rows for Event_Id if it contains multiple comma-separated values.</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 'Date' column appears to be single-valued in this dataset, so it's not included here.</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If Date could also have multiple values (e.g., "1/10, 2/10"), you would add it to separate_rows.</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(Event_Id, <span class="at">sep =</span> <span class="st">", "</span>, <span class="at">convert =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Trim whitespace again after separation in case of leading/trailing spaces</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), str_trim)) <span class="sc">%&gt;%</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert Date to actual date objects for proper sorting.</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using `dmy` for day/month/year format and assuming the current year (2025).</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">FullDate =</span> <span class="fu">paste0</span>(Date, <span class="st">"/2025"</span>), <span class="co"># Add the current year for correct parsing</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">ParsedDate =</span> <span class="fu">dmy</span>(FullDate, <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="co"># Convert to Date object (Day Month Year)</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Order the data by parsed date and then event ID</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ParsedDate, Event_Id) <span class="sc">%&gt;%</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FullDate) <span class="sc">%&gt;%</span> <span class="co"># Remove the helper column</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure Event_Id is character type for display purposes</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Event_Id =</span> <span class="fu">as.character</span>(Event_Id))</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Create the reactable table</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>  df_processed,</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="co"># Enable column filters at the top of each column</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="co"># Add a global search box above the table</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">paginationType =</span> <span class="st">"numbers"</span>, <span class="co"># Display page numbers (e.g., 1, 2, 3 instead of Prev/Next)</span></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="co"># Show 5 rows per page by default</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="co"># Allow users to select different page sizes</span></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>), <span class="co"># Available page size options</span></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="co"># Add alternating row colors for better readability</span></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="co"># Highlight the row when the user hovers over it</span></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the default sorting for the table when it first loads</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultSorted =</span> <span class="fu">list</span>(<span class="at">ParsedDate =</span> <span class="st">"asc"</span>), <span class="co"># Sort by the hidden ParsedDate column in ascending order</span></span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The 'ParsedDate' column is used internally for correct date sorting but is not displayed</span></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">ParsedDate =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">show =</span> <span class="cn">FALSE</span></span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define how each visible column should be displayed and behave</span></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">Date =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Date"</span>, <span class="co"># Display name for the column header</span></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>, <span class="co"># Ensure initial sort is ascending for the displayed date</span></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">80</span>, <span class="co"># Minimum width for the column to ensure content fits</span></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"center"</span> <span class="co"># Align text to the center for better presentation of dates</span></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sender =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sender"</span>, <span class="at">minWidth =</span> <span class="dv">120</span>),</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Recipient =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Recipient"</span>, <span class="at">minWidth =</span> <span class="dv">120</span>),</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">Commonalities =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Commonalities"</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rationale =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Rationale"</span>, <span class="at">minWidth =</span> <span class="dv">300</span>),</span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Custom definition for the 'Suspicious_Status' column to display its original name</span></span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">Suspicious_Status =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Suspicious?"</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">Event_Id =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Event ID"</span>, <span class="co"># Display name for the column header</span></span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">80</span>, <span class="co"># Minimum width</span></span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"center"</span> <span class="co"># Align text to the center</span></span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Customize the visual theme of the reactable table for a consistent look and feel</span></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#dfe2e5"</span>, <span class="co"># Defines the color of table borders</span></span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span>, <span class="co"># Defines the background color of striped rows</span></span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightColor =</span> <span class="st">"#f0f5f9"</span>, <span class="co"># Defines the background color when a row is hovered over</span></span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">cellPadding =</span> <span class="st">"8px 12px"</span>, <span class="co"># Sets the padding inside table cells</span></span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontFamily =</span> <span class="st">"Verdana, Geneva, sans-serif"</span>, <span class="at">fontSize =</span> <span class="st">"14px"</span>), <span class="co"># General font family and size for table content</span></span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;.rt-th:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">backgroundColor =</span> <span class="st">"#e0e6eb"</span>), <span class="co"># Hover effect for table headers</span></span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">fontSize =</span> <span class="st">"15px"</span>, <span class="co"># Font size for headers</span></span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">fontWeight =</span> <span class="dv">600</span>, <span class="co"># Font weight for headers (bold)</span></span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"#333"</span>, <span class="co"># Text color for headers</span></span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">background =</span> <span class="st">"#f7f7f7"</span> <span class="co"># Background color for headers</span></span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">rowSelectedStyle =</span> <span class="fu">list</span>(<span class="at">backgroundColor =</span> <span class="st">"#e6f2ff"</span>, <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">backgroundColor =</span> <span class="st">"#e6f2ff"</span>)), <span class="co"># Style for selected rows</span></span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchInputStyle =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">margin =</span> <span class="st">"5px 0"</span>, <span class="at">padding =</span> <span class="st">"5px"</span>), <span class="co"># Style for the global search input box</span></span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">filterInputStyle =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">margin =</span> <span class="st">"2px 0"</span>, <span class="at">padding =</span> <span class="st">"4px"</span>) <span class="co"># Style for individual column filter input boxes</span></span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="question-2b" class="level1">
<h1>Question 2b)</h1>
<section id="centrality-measure--all" class="level3">
<h3 class="anchored" data-anchor-id="centrality-measure--all">7.5.2 Centrality Measure- All</h3>
<p>We then proceeded to use the PageRank centrality algorithm to assign a numerical weight to each node to reflect its importance. The community attribute we previously calculated was then assigned to this graph.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">PageRank Centrality Algorithm</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">The Network</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">

</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">

</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --- STEP: Compute Centrality Measures ---</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pagerank =</span> <span class="fu">centrality_pagerank</span>(),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">betweenness =</span> <span class="fu">centrality_betweenness</span>(),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">closeness =</span> <span class="fu">centrality_closeness</span>()</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Show top 10 nodes by PageRank</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>g <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, pagerank, degree, betweenness, closeness) <span class="sc">%&gt;%</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pagerank)) <span class="sc">%&gt;%</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize by Centrality</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(g, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> pagerank, <span class="at">color =</span> <span class="fu">as.factor</span>(community)), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">max.iter =</span> <span class="dv">5000</span>) <span class="sc">+</span> <span class="co"># &lt;--- Increased this value </span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Network with PageRank Centrality"</span>,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"PageRank"</span>, <span class="at">color =</span> <span class="st">"Community"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="findings-1" class="level4">
<h4 class="anchored" data-anchor-id="findings-1"><strong>7.5.2.1 Findings</strong>:</h4>
<ul>
<li>There were around 6 closely associated groups. Community 5 (Clepper and Miranda) appeared to be segmented from the central group, due to the non-involvement from the nature of the investigative work.</li>
<li>From the graph, we extracted the 11 influential nodes to focus on:
<ul>
<li>Community 1: Reef Guardian, EcoVigil</li>
<li>Community 2: Neptune, Remora, Nadia, V. Miesel Shipping, Davis</li>
<li>Community 3: Mako</li>
<li>Community 4: Mrs.&nbsp;Money, Boss, The Middleman</li>
<li>Community 5: N/A as they were not very influential at global level</li>
<li>Community 6: N/A as they were not very influential at global level</li>
</ul></li>
</ul>
</section>
</section>
<section id="community-group-membership--all" class="level3">
<h3 class="anchored" data-anchor-id="community-group-membership--all">3.3.1 Community Group Membership- All</h3>
<p>The topic area was gathered from the bigram wordclouds and circular bar chart. The Group Name was created based on knowledge from the Members in the group and the topic area. These were the information from the 6 segmented groups:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">The Table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">

</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="sourceCode" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Create a tidy summary table of members per community</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>grouped_members <span class="ot">&lt;-</span> g <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, community) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Members =</span> <span class="fu">paste</span>(<span class="fu">sort</span>(name), <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Group Number</span><span class="st">`</span> <span class="ot">=</span> community,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Topic Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"green guardians, city council, paackland harbor, green guardians, nemo reef, water quality"</span>,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"nemo reef, miesel shipping, permit, cr 7844, delta 3"</span>,</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"nemo reef, himark harbor, samantha blake, radio silence"</span>,</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"money, 0500 meeting, nemo reef, intern reporting, conservation activity, financial projections"</span>,</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"sam, kelly, loading equipment"</span>,</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"miranda reporting, jensen, project poseidon, conservation vessels, nemo reef"</span>,</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Group Name</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Conservationist Group"</span>,</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Sailor Shift"</span>,</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Maritime"</span>,</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Suspicious Characters"</span>,</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Sam &amp; Kelly"</span>,</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"Hacklee Herald"</span>,</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Miscellaneous"</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Group Number</span><span class="st">`</span>, <span class="st">`</span><span class="at">Topic Area</span><span class="st">`</span>, <span class="st">`</span><span class="at">Members</span><span class="st">`</span>, <span class="st">`</span><span class="at">Group Name</span><span class="st">`</span>)</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the summary table in a clean format</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(grouped_members, <span class="at">caption =</span> <span class="st">"Community Group Membership Summary"</span>, <span class="at">align =</span> <span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="findings-2" class="level4">
<h4 class="anchored" data-anchor-id="findings-2"><strong>3.3.1.1 Findings:</strong></h4>
<ul>
<li>We focused on the 11 nodes in the suspicious groups named:
<ul>
<li>Sailor Shift (Influential Nodes: Neptune, Remora, Nadia, V. Miesel Shipping, Davis);</li>
<li>Maritime (Influential Node: Mako);</li>
<li>Conservationist Group: (Influential Nodes: Reef Guardian, EcoVigil); and</li>
<li>Suspicious Characters (Influential Nodes: Mrs.&nbsp;Money, Boss, The Middleman).</li>
</ul></li>
<li>We held back on the slightly less influential nodes such as: Sam &amp; Kelly, and Hacklee Herald which was where Clepper Jensen worked as a journalist.</li>
</ul>
</section>
</section>
<section id="centrality-measure--people-vessels" class="level3">
<h3 class="anchored" data-anchor-id="centrality-measure--people-vessels">7.5.8 Centrality Measure- People &amp; Vessels</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">PageRank Centrality Algorithm</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">The Network</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">

</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">

</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="sourceCode" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --- STEP: Compute Centrality Measures ---</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>g_pv <span class="ot">&lt;-</span> g_pv <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pagerank =</span> <span class="fu">centrality_pagerank</span>(),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">betweenness =</span> <span class="fu">centrality_betweenness</span>(),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">closeness =</span> <span class="fu">centrality_closeness</span>()</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Show top 10 nodes by PageRank</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>g_pv <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, pagerank, degree, betweenness, closeness) <span class="sc">%&gt;%</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pagerank)) <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize by Centrality</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(g_pv, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> pagerank, <span class="at">color =</span> <span class="fu">as.factor</span>(community)), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Network with PageRank Centrality"</span>,</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"PageRank"</span>, <span class="at">color =</span> <span class="st">"Community"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="findings-3" class="level4">
<h4 class="anchored" data-anchor-id="findings-3"><strong>3.4.1.1 Findings:</strong></h4>
<ul>
<li>There were 5 closely associated groups. Community 5 (Clepper and Miranda) appeared to be segmented from the central group, due to the non-involvement from the nature of their investigative work.</li>
<li>From the graph, we extracted the 8 influential nodes to focus on:
<ul>
<li>Community 1: Mako</li>
<li>Community 2: Neptune, Remora, Nadia, Davis</li>
<li>Community 3: N/A as they were not very influential at global level</li>
<li>Community 4: Mrs.&nbsp;Money, Boss, The Middleman</li>
<li>Community 5: N/A as they were not very influential at global level</li>
</ul></li>
</ul>
</section>
</section>
<section id="wordclouds--bigrams" class="level3">
<h3 class="anchored" data-anchor-id="wordclouds--bigrams">7.5.9 Wordclouds- Bigrams</h3>
<p>We focused on bigrams here to get more contextual data from two instead of one word.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">The Wordclouds</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">

</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="sourceCode" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5b. Plot word clouds per community</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>valid_communities <span class="ot">&lt;-</span> <span class="fu">unique</span>(g_pv <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>(community))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))  <span class="co"># Still allocate 6 slots, but you can adjust this</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">sort</span>(valid_communities)) {</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  words <span class="ot">&lt;-</span> bigrams <span class="sc">%&gt;%</span> <span class="fu">filter</span>(community <span class="sc">==</span> i)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(words) <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="cf">next</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>({</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">432</span>)  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">wordcloud</span>(<span class="at">words =</span> words<span class="sc">$</span>bigram,  <span class="co"># &lt;-- FIXED here</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">freq =</span> words<span class="sc">$</span>n,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">max.words =</span> <span class="fu">min</span>(<span class="dv">30</span>, <span class="fu">nrow</span>(words)),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">0.5</span>),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>),</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">random.order =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="fu">paste</span>(<span class="st">"Community"</span>, i), <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="dv">1</span>, <span class="at">adj =</span> <span class="fl">0.5</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="circular-barchart-for-top-bigrams-per-community" class="level3">
<h3 class="anchored" data-anchor-id="circular-barchart-for-top-bigrams-per-community">7.5.10 Circular barchart for Top Bigrams per Community</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">The Circular Barchart</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">

</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="sourceCode" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>valid_communities <span class="ot">&lt;-</span> g_pv <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(community)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>bigrams <span class="ot">&lt;-</span> bigrams <span class="sc">%&gt;%</span> <span class="fu">filter</span>(community <span class="sc">%in%</span> valid_communities)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Configuration ---</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>num_top_bigrams_per_community <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>empty_bar_count <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># gaps btw comm.</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co">#excluded_community &lt;- 5 # too little in community 5</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Prepare the Combined Dataset ---</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>all_communities_data <span class="ot">&lt;-</span> bigrams <span class="sc">%&gt;%</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter(community != excluded_community) %&gt;%</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> num_top_bigrams_per_community) <span class="sc">%&gt;%</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>all_communities_data<span class="sc">$</span>community <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(all_communities_data<span class="sc">$</span>community)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>to_add <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">bigram =</span> <span class="cn">NA</span>,</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="cn">NA</span>,</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">community =</span> <span class="fu">rep</span>(<span class="fu">levels</span>(all_communities_data<span class="sc">$</span>community), <span class="at">each =</span> empty_bar_count)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_communities_data, to_add) <span class="sc">%&gt;%</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(community)</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(plot_data)) <span class="co"># Keep ID as numeric here</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Prepare Label Data ---</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>label_data <span class="ot">&lt;-</span> plot_data</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>number_of_bar <span class="ot">&lt;-</span> <span class="fu">nrow</span>(label_data)</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>label_data<span class="sc">$</span>angle <span class="ot">&lt;-</span> <span class="dv">90</span> <span class="sc">-</span> <span class="dv">360</span> <span class="sc">*</span> (label_data<span class="sc">$</span>id <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">/</span> number_of_bar</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>label_data<span class="sc">$</span>hjust <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(label_data<span class="sc">$</span>angle <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">90</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>label_data<span class="sc">$</span>angle <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(label_data<span class="sc">$</span>angle <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">90</span>, label_data<span class="sc">$</span>angle <span class="sc">+</span> <span class="dv">180</span>, label_data<span class="sc">$</span>angle)</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Prepare Data for Baselines (Community Dividers) ---</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>base_data <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">min</span>(id, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Keep as numeric</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">end =</span> <span class="fu">max</span>(id, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> empty_bar_count <span class="co"># Keep as numeric</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_position =</span> <span class="fu">mean</span>(<span class="fu">c</span>(start, end))</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. Prepare Data for Grid Lines (Optional: Value Scales) ---</span></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>max_n_value <span class="ot">&lt;-</span> <span class="fu">max</span>(plot_data<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>grid_lines_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>)</span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>grid_lines_values <span class="ot">&lt;-</span> grid_lines_values[grid_lines_values <span class="sc">&lt;=</span> max_n_value]</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>grid_segments_data <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_id =</span> <span class="fu">min</span>(id, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Keep as numeric</span></span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_id =</span> <span class="fu">max</span>(id, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> empty_bar_count <span class="co"># Keep as numeric</span></span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>grid_data_final <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(val <span class="cf">in</span> grid_lines_values) {</span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>  temp_data <span class="ot">&lt;-</span> grid_segments_data <span class="sc">%&gt;%</span></span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">y_value =</span> val)</span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a>  grid_data_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(grid_data_final, temp_data)</span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Data for grid line LABELS ---</span></span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>grid_label_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_pos =</span> <span class="fu">max</span>(plot_data<span class="sc">$</span>id, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="dv">2</span>, <span class="co"># Fixed x position outside the plot</span></span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_pos =</span> grid_lines_values,</span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">label_text =</span> <span class="fu">as.character</span>(grid_lines_values)</span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 5. Make the Unified Plot ---</span></span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> n, <span class="at">fill =</span> community)) <span class="sc">+</span> <span class="co"># &lt;--- x = id (numeric)</span></span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add background grid lines for value (e.g., 20, 40, 60, 80)</span></span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> grid_data_final,</span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> start_id <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">y =</span> y_value, <span class="at">xend =</span> end_id <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">yend =</span> y_value),</span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a>               <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text showing the value of each grid line at a fixed position</span></span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> grid_label_data,</span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x_pos, <span class="at">y =</span> y_pos, <span class="at">label =</span> label_text),</span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bars for the bigrams (main plot elements)</span></span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># &lt;--- Add width=1 to remove space between bars if id is numeric</span></span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-102"><a href="#cb43-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set limits for the y-axis, providing space for labels</span></span>
<span id="cb43-103"><a href="#cb43-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span>max_n_value <span class="sc">*</span> <span class="fl">0.7</span>, max_n_value <span class="sc">*</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb43-104"><a href="#cb43-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-105"><a href="#cb43-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-106"><a href="#cb43-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb43-107"><a href="#cb43-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb43-108"><a href="#cb43-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-109"><a href="#cb43-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-110"><a href="#cb43-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-111"><a href="#cb43-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>), <span class="st">"cm"</span>) <span class="co"># Top, Right, Bottom, Left margins</span></span>
<span id="cb43-112"><a href="#cb43-112" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-113"><a href="#cb43-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb43-114"><a href="#cb43-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-115"><a href="#cb43-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add bigram labels</span></span>
<span id="cb43-116"><a href="#cb43-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb43-117"><a href="#cb43-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> label_data,</span>
<span id="cb43-118"><a href="#cb43-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> n <span class="sc">+</span> <span class="dv">10</span>, <span class="at">label =</span> bigram, <span class="at">hjust =</span> hjust), <span class="co"># &lt;--- x = id (numeric)</span></span>
<span id="cb43-119"><a href="#cb43-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">2.8</span>,</span>
<span id="cb43-120"><a href="#cb43-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> label_data<span class="sc">$</span>angle, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb43-121"><a href="#cb43-121" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-122"><a href="#cb43-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-123"><a href="#cb43-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add base lines for each community segment</span></span>
<span id="cb43-124"><a href="#cb43-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb43-125"><a href="#cb43-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> base_data,</span>
<span id="cb43-126"><a href="#cb43-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> start <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">xend =</span> end <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">yend =</span> <span class="sc">-</span><span class="dv">10</span>),</span>
<span id="cb43-127"><a href="#cb43-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb43-128"><a href="#cb43-128" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-129"><a href="#cb43-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-130"><a href="#cb43-130" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add community group labels</span></span>
<span id="cb43-131"><a href="#cb43-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb43-132"><a href="#cb43-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> base_data,</span>
<span id="cb43-133"><a href="#cb43-133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> title_position, <span class="at">y =</span> <span class="sc">-</span><span class="dv">40</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Comm."</span>, community)),</span>
<span id="cb43-134"><a href="#cb43-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb43-135"><a href="#cb43-135" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb43-136"><a href="#cb43-136" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Add the Title ---</span></span>
<span id="cb43-137"><a href="#cb43-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-138"><a href="#cb43-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Circular Bar Chart by Community"</span>,</span>
<span id="cb43-139"><a href="#cb43-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Frequencies of key bigrams within each community"</span>, <span class="co"># Updated subtitle</span></span>
<span id="cb43-140"><a href="#cb43-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">"AT | Generated: "</span>, <span class="fu">Sys.Date</span>())</span>
<span id="cb43-141"><a href="#cb43-141" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-142"><a href="#cb43-142" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply the Set2 Brewer palette</span></span>
<span id="cb43-143"><a href="#cb43-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb43-144"><a href="#cb43-144" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Customize title appearance ---</span></span>
<span id="cb43-145"><a href="#cb43-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb43-146"><a href="#cb43-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb43-147"><a href="#cb43-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb43-148"><a href="#cb43-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> <span class="st">"grey50"</span>)</span>
<span id="cb43-149"><a href="#cb43-149" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-150"><a href="#cb43-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-151"><a href="#cb43-151" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="community-group-membership--people-vessels" class="level3">
<h3 class="anchored" data-anchor-id="community-group-membership--people-vessels">7.5.11 Community Group Membership- People &amp; Vessels</h3>
<p>The topic area was gathered from the bigram wordclouds and circular bar chart. The Group Name was created based on knowledge from the Members in the group and the topic area. These are the information for the 5 segmented groups:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">The Table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">

</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="sourceCode" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Create a tidy summary table of members per community</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>grouped_members <span class="ot">&lt;-</span> g_pv <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, community) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Members =</span> <span class="fu">paste</span>(<span class="fu">sort</span>(name), <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Group Number</span><span class="st">`</span> <span class="ot">=</span> community,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Topic Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"nemo reef, himark harbor, samantha blake, city council"</span>,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"south dock, equipment transfer, security team, nemo reef, delta3, cr 7844"</span>,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"intern reporting, conservation vessels, nemo reef"</span>,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"10am tomorrow, 0500 tomorrow, funding channels, alternative funding"</span>,</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"classification markings, project poseidon, clearance documents, harbor security"</span>,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Group Name</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Conservationist Group"</span>,</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Permit"</span>,</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Pseudonym"</span>,</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Suspicious"</span>,</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>      community <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Hacklee Herald"</span>,</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Miscellaneous"</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Group Number</span><span class="st">`</span>, <span class="st">`</span><span class="at">Topic Area</span><span class="st">`</span>, <span class="st">`</span><span class="at">Members</span><span class="st">`</span>, <span class="st">`</span><span class="at">Group Name</span><span class="st">`</span>)</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the summary table in a clean format</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(grouped_members, <span class="at">caption =</span> <span class="st">"Community Group Membership Summary"</span>, <span class="at">align =</span> <span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="findings-4" class="level4">
<h4 class="anchored" data-anchor-id="findings-4"><strong>7.5.11.1 Findings:</strong></h4>
<ul>
<li>Movements and changes in membership since section 7.5.6:
<ul>
<li>Mako moved from Maritime to Conservationist.</li>
<li>Samantha Blake moved from the Suspicious Characters to Conservationist.</li>
<li>Sam and Kelly moved from their own Community to Pseudonym.</li>
<li>The Lookout moved from Conservationist Group to Pseudonym.</li>
<li>The Intern moved from Suspicious Characters to Pseudonym.</li>
<li>Sailor Shift community renamed to Permit</li>
</ul></li>
<li>From 11 nodes in section 7.5.6.1, we further narrowed down on the 8 nodes in the suspicious groups named:
<ul>
<li>Permit (Influential Nodes: Neptune, Remora, Nadia, Davis);</li>
<li>Conservationist Group (Influential Node: Mako);</li>
<li>Suspicious (Influential Nodes: Mrs.&nbsp;Money, Boss, The Middleman).</li>
</ul></li>
<li>We held back on the slightly less influential nodes such as: Hacklee Herald which was where Clepper Jensen worked as a journalist.</li>
</ul>
</section>
</section>
<section id="discussion-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="discussion-interpretation">7.5.13 Discussion/ Interpretation:</h3>
<p>We mainly focused on the conversations by 8 influential nodes and some related nodes:</p>
<ul>
<li><p><strong>Conservation Group</strong> (Comm.1): Samantha Blake informed Mako to stop operations on 8 and 10th Oct.&nbsp;Serenity is a private luxury yacht. Osprey was likely a tourism vessel looking for charter from Mako for their tourists.</p></li>
<li><p><strong>Permit</strong> (Comm. 2): Neptune, Remora, Nadia, and Davis were working on Nemo Reef operation. This referred to the Music Video Production for Sailor Shift on 14 Oct.</p></li>
<li><p><strong>Pseudonym</strong> (Comm. 3): Other than communicating among themselves, The Lookout appeared to have also externally corresponded with Sentinel, Reef Guardian and Horizon (conservation based topics), while The Intern also externally corresponded with Mrs.&nbsp;Money.</p></li>
<li><p><strong>Suspicious</strong> (Comm. 4): The Middleman had access to Council documents. Mrs.&nbsp;Money had funding from sources that would not flag out to regulators for her operations. Mrs.&nbsp;Money was investigating V. Mieselâ€™s structures. On 5 Oct, Boss told Mrs.&nbsp;Money to disguise financial trails through tourism ventures and destroy evidence of Nemo Reef operations.</p></li>
<li><p><strong>Hacklee Herald</strong> (Comm. 5): Conversations between Clepper and his intern Miranda which ended on 11 Oct.&nbsp;Miranda mentioned an Oceanus City Council Member meeting with unmarked vessels at night.</p></li>
</ul>
</section>
</section>
<section id="tackling-question-3" class="level1">
<h1><strong>Tackling Question 3</strong></h1>
</section>
<section id="question-3a" class="level1">
<h1>Question 3a)</h1>
<section id="entities-breakdown" class="level2">
<h2 class="anchored" data-anchor-id="entities-breakdown">8.1 Entities Breakdown</h2>
<p><strong>Core Logic:</strong></p>
<ul>
<li><p>If two names appear as sender and recipient in the same message, they cannot belong to the same person â€” i.e., theyâ€™re not aliases of each other.</p></li>
<li><p>If two names sent a message at the exact time, they cannot belong to the same person.</p></li>
</ul>
<p>We created Alluvial Diagrams to chart: real_identity â†’ observed_name â†’ community</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Extraction of the list of Entity names</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Manual Mapping</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>unique_names <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(other_communications_df<span class="sc">$</span>sender_name, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                              other_communications_df<span class="sc">$</span>recipient_name)))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>unique_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>name_mapping <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">observed_name =</span> <span class="fu">c</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Boss"</span>, <span class="st">"City Officials"</span>, <span class="st">"Clepper Jensen"</span>, <span class="st">"Davis"</span>, <span class="st">"Defender"</span>, <span class="st">"EcoVigil"</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Elise"</span>, <span class="st">"Glitters Team"</span>, <span class="st">"Green Guardians"</span>, <span class="st">"Haacklee Harbor"</span>, <span class="st">"Himark Harbor"</span>, <span class="st">"Horizon"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kelly"</span>, <span class="st">"Knowles"</span>, <span class="st">"Liam Thorne"</span>, <span class="st">"Mako"</span>, <span class="st">"Marlin"</span>, <span class="st">"Miranda Jordan"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mrs. Money"</span>, <span class="st">"Nadia Conti"</span>, <span class="st">"Neptune"</span>, <span class="st">"Northern Light"</span>, <span class="st">"Oceanus City Council"</span>, <span class="st">"Osprey"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Paackland Harbor"</span>, <span class="st">"Port Security"</span>, <span class="st">"Reef Guardian"</span>, <span class="st">"Remora"</span>, <span class="st">"Rodriguez"</span>, <span class="st">"Sailor Shift Team"</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sam"</span>, <span class="st">"Samantha Blake"</span>, <span class="st">"Seawatch"</span>, <span class="st">"Sentinel"</span>, <span class="st">"Serenity"</span>, <span class="st">"Small Fry"</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The Accountant"</span>, <span class="st">"The Intern"</span>, <span class="st">"The Lookout"</span>, <span class="st">"The Middleman"</span>, <span class="st">"V. Miesel Shipping"</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">real_identity =</span> <span class="fu">c</span>(</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nadia Conti"</span>, <span class="st">"Oceanus City Council"</span>, <span class="st">"Clepper Jensen"</span>, <span class="st">"Captain Davis"</span>, <span class="st">"Sentinel"</span>, <span class="st">"EcoVigil"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Elise"</span>, <span class="st">"Sailor Shift Team"</span>, <span class="st">"Green Guardians"</span>, <span class="st">"Harbor Authority"</span>,<span class="st">"Harbor Authority"</span>, <span class="st">"Horizon"</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kelly"</span>, <span class="st">"Knowles"</span>, <span class="st">"Liam Thorne"</span>, <span class="st">"Mako"</span>, <span class="st">"Small Fishing Vessel"</span>, <span class="st">"Miranda Jordan"</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Elise"</span>, <span class="st">"Nadia Conti"</span>, <span class="st">"Neptune"</span>, <span class="st">"Commercial Vessel"</span>, <span class="st">"Oceanus City Council"</span>, <span class="st">"Tourism Vessel"</span>,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Harbor Authority"</span>, <span class="st">"Oceanus City Council"</span>, <span class="st">"Reef Guardian"</span>, <span class="st">"Remora"</span>, <span class="st">"Rodriguez"</span>, <span class="st">"Sailor Shift Team"</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sam"</span>, <span class="st">"Samantha Blake"</span>, <span class="st">"Kelly"</span>, <span class="st">"Sentinel"</span>, <span class="st">"Private Luxury Yacht"</span>, <span class="st">"Rodriguez"</span>,</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Elise"</span>, <span class="st">"Sam"</span>, <span class="st">"Kelly"</span>, <span class="st">"Liam Thorne"</span>, <span class="st">"V. Miesel Shipping"</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">community =</span> <span class="fu">c</span>(</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"V. Miesel Shipping"</span>, <span class="st">"City Council"</span>, <span class="st">"Haacklee Herald"</span>, <span class="st">"V. Miesel Shipping"</span>, <span class="st">"Local Conservationist Group"</span>, <span class="st">"Local Conservationist Group"</span>,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"V. Miesel Shipping"</span>, <span class="st">"Sailor Shift Team"</span>, <span class="st">"Local Conservationist Group"</span>, <span class="st">"Harbor Authority"</span>, <span class="st">"Harbor Authority"</span>, <span class="st">"Local Conservationist Group"</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Local Conservationist Group"</span>, <span class="st">"V. Miesel Shipping"</span>, <span class="st">"City Council"</span>, <span class="st">"V. Miesel Shipping"</span>, <span class="st">"Maritime"</span>, <span class="st">"Haacklee Herald"</span>,</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"V. Miesel Shipping"</span>, <span class="st">"V. Miesel Shipping"</span>, <span class="st">"V. Miesel Shipping"</span>, <span class="st">"Maritime"</span>, <span class="st">"City Council"</span>, <span class="st">"Maritime"</span>,</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Harbor Authority"</span>, <span class="st">"City Council"</span>, <span class="st">"Local Conservationist Group"</span>, <span class="st">"V. Miesel Shipping"</span>, <span class="st">"V. Miesel Shipping"</span>, <span class="st">"Sailor Shift Team"</span>,</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"V. Miesel Shipping"</span>, <span class="st">"Sailor Shift Team"</span>, <span class="st">"Local Conservationist Group"</span>, <span class="st">"Local Conservationist Group"</span>, <span class="st">"Maritime"</span>, <span class="st">"V. Miesel Shipping"</span>,</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"V. Miesel Shipping"</span>, <span class="st">"V. Miesel Shipping"</span>, <span class="st">"Local Conservationist Group"</span>, <span class="st">"City Council"</span>, <span class="st">"V. Miesel Shipping"</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>multi_members <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">observed_name =</span> <span class="fu">c</span>(</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  City Council members (additional to existing)</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Commissioner Blake"</span>, <span class="st">"Commissioner Torres"</span>, <span class="st">"Council Knowles"</span>, <span class="st">"The Middleman"</span>, <span class="st">"Jensen from City Council"</span>, <span class="st">"Liam Thorne"</span>,</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sailor Shift Team (may already exist, but we ensure all)</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Boss"</span>, <span class="st">"Council Knowles"</span>, <span class="st">"Davis"</span>, <span class="st">"Glitters Team"</span>, <span class="st">"Liam Thorne"</span>, <span class="st">"Mako"</span>, <span class="st">"Mrs. Money"</span>, <span class="st">"Nadia Conti"</span>, <span class="st">"Neptune"</span>,</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Remora"</span>, <span class="st">"Rodriguez"</span>, <span class="st">"Sam"</span>, <span class="st">"Samantha Blake"</span>, <span class="st">"Small Fry"</span>, <span class="st">"The Accountant"</span>, <span class="st">"The Intern"</span>, <span class="st">"The Middleman"</span>, <span class="st">"Elise"</span>,</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  Influential Families</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Council Knowles"</span>, <span class="st">"V. Miesel Shipping"</span>,</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  Conservationist Group</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Defender"</span>, <span class="st">"EcoVigil"</span>, <span class="st">"Green Guardians"</span>, <span class="st">"Horizon"</span>, <span class="st">"Kelly"</span>, <span class="st">"Reef Guardian"</span>, <span class="st">"Seawatch"</span>, <span class="st">"Sentinel"</span>, <span class="st">"The Lookout"</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">real_identity =</span> <span class="fu">c</span>(</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Commissioner Blake"</span>, <span class="st">"Commissioner Torres"</span>, <span class="st">"Council Knowles"</span>, <span class="st">"Liam Thorne"</span>, <span class="st">"Clepper Jensen"</span>, <span class="st">"Liam Thorne"</span>,</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nadia Conti"</span>, <span class="st">"Council Knowles"</span>, <span class="st">"Captain Davis"</span>, <span class="st">"Sailor Shift Team"</span>, <span class="st">"Liam Thorne"</span>, <span class="st">"Mako"</span>, <span class="st">"Elise"</span>, <span class="st">"Nadia Conti"</span>, <span class="st">"Neptune"</span>,</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Remora"</span>, <span class="st">"Rodriguez"</span>, <span class="st">"Sam"</span>, <span class="st">"Samantha Blake"</span>, <span class="st">"Rodriguez"</span>, <span class="st">"Elise"</span>, <span class="st">"Sam"</span>, <span class="st">"Liam Thorne"</span>, <span class="st">"Elise"</span>,</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Council Knowles"</span>, <span class="st">"V. Miesel Shipping"</span>,</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sentinel"</span>, <span class="st">"EcoVigil"</span>, <span class="st">"Green Guardians"</span>, <span class="st">"Horizon"</span>, <span class="st">"Kelly"</span>, <span class="st">"Reef Guardian"</span>, <span class="st">"The Lookout"</span>, <span class="st">"Sentinel"</span>, <span class="st">"Kelly"</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">community =</span> <span class="fu">c</span>(</span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"City Council"</span>, <span class="dv">6</span>),</span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"Sailor Shift Team"</span>, <span class="dv">18</span>),</span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"Influential Families"</span>, <span class="dv">2</span>),</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"Local Conservationist Group"</span>, <span class="dv">9</span>)</span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="entities--interactive-alluvial-diagrams" class="level2">
<h2 class="anchored" data-anchor-id="entities--interactive-alluvial-diagrams">Entities- Interactive Alluvial Diagrams</h2>
<p>Hover to see details for individual identities.</p>
<p>Real Identity from analysis -&gt; Observed Name from data -&gt; Community</p>
<p>This will probably be a drop down for each name in Shiny.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Libraries ---</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalluvial)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Build Alluvial Dataset ---</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>alluvial_data <span class="ot">&lt;-</span> name_mapping <span class="sc">%&gt;%</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(multi_members) <span class="sc">%&gt;%</span> <span class="co"># Combine the two data sources</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> <span class="co"># Remove any duplicate rows after combining</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(real_identity) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(community)) <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(real_identity, observed_name, community, <span class="at">name =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tooltip =</span> <span class="fu">paste0</span>( <span class="co"># Create the tooltip string</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Real Identity: "</span>, real_identity, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Observed Name: "</span>, observed_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Community: "</span>, community, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Count: "</span>, value</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Create static ggplot object (original version) ---</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(alluvial_data,</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">axis1 =</span> real_identity, <span class="at">axis2 =</span> observed_name, <span class="at">axis3 =</span> community,</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> value,</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">text =</span> tooltip <span class="co"># Map the custom tooltip string to the 'text' aesthetic</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>            )) <span class="sc">+</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> real_identity), <span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">text =</span> <span class="cn">NULL</span>)) <span class="sc">+</span> <span class="co"># No dual-role fill here</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)), <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Real Identity"</span>, <span class="st">"Observed Name"</span>, <span class="st">"Community"</span>),</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">25</span>)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"All Identity Flows"</span>,</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Link Count"</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="co"># No legend for fill here</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">80</span>, <span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. Convert to interactive Plotly object ---</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a><span class="co"># 'tooltip = "text"' tells Plotly to use the content of the 'text' aesthetic</span></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>, <span class="at">height =</span> <span class="dv">800</span>, <span class="at">width =</span> <span class="dv">1000</span>)</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="co"># This line will print the Plotly object in  Quarto output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="question-3b" class="level1">
<h1>Question 3b)</h1>
<p>We created a graph with the characterâ€™s original name, pseudonyms, and supplemented with any background information we learnt of. For instance, we learnt that Davis was a captain, or that Serenity was a private luxury yacht.Here, it is easier to determine who is using which pseudonyms by clicking on the real identity drop down panel which will then only segregate to the individualâ€™s Real Identity, Observed Name, and Community.</p>
</section>
<section id="question-3c" class="level1">
<h1>Question 3c)</h1>
<p>Understanding pseudonyms significantly reshapes our interpretation of the events in Oceanus. Without resolving aliases, the communication network appears fragmented â€” it may seem like dozens of separate individuals are involved. However, by mapping pseudonyms to real identities, we discover that a small number of actors are coordinating more activity than initially apparent. For example, a person using multiple pseudonyms may appear in many places at once â€” suggesting high influence or deception. This reveals orchestrated behavior, such as coordinated logistics, manipulation of event timelines, or masking involvement in controversial operations.</p>
</section>
<section id="tackling-question-4" class="level1">
<h1><strong>9) Tackling Question 4</strong></h1>
</section>
<section id="question-4a" class="level1">
<h1>Question 4a)</h1>
<section id="nadias-ego-network--louvain-community" class="level2">
<h2 class="anchored" data-anchor-id="nadias-ego-network--louvain-community">9.1 Nadiaâ€™s Ego Network- Louvain community</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Ego Network</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">

</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="sourceCode" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume g_full includes Nadia â€” not g from other_communications_df</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>g_igraph <span class="ot">&lt;-</span> <span class="fu">as.igraph</span>(g)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirm Nadia exists</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">"Nadia Conti"</span> <span class="sc">%in%</span> <span class="fu">V</span>(g_igraph)<span class="sc">$</span>name) <span class="fu">stop</span>(<span class="st">"Nadia Conti not found in the graph."</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get ego subgraph</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>nadia_ego_igraph <span class="ot">&lt;-</span> <span class="fu">make_ego_graph</span>(g_igraph, <span class="at">order =</span> <span class="dv">1</span>, <span class="at">nodes =</span> <span class="fu">which</span>(<span class="fu">V</span>(g_igraph)<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>), <span class="at">mode =</span> <span class="st">"all"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to tidygraph</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>nadia_ego_graph <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(nadia_ego_igraph)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to undirected for Louvain</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>nadia_ego_graph <span class="ot">&lt;-</span> nadia_ego_graph <span class="sc">%&gt;%</span> </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_undirected</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">community =</span> <span class="fu">group_louvain</span>(),</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pagerank =</span> <span class="fu">centrality_pagerank</span>()</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Nadia's ego network</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(nadia_ego_graph, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> pagerank, <span class="at">color =</span> <span class="fu">as.factor</span>(community)), <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nadia Contiâ€™s Ego Network"</span>,</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Nodes sized by PageRank, colored by Louvain community"</span>,</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Community"</span>,</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"PageRank"</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>We wanted to find out if there were sub communities within Nadiaâ€™s direct network that worked closely together.</li>
<li>The orange community were possibly involved in Sailor Shiftsâ€™s music video, while the green community were likely regarding ensuring compliance to authorities such as officials, the harbour and conservation team.</li>
<li>Nadia, Elise, and Marlin were the orange nodes that directly linked to the green nodes.</li>
</ul>
</section>
<section id="nadias-sent-and-received-ego-networks--viznetwork" class="level2">
<h2 class="anchored" data-anchor-id="nadias-sent-and-received-ego-networks--viznetwork">9.2 Nadiaâ€™s Sent and Received Ego Networks- VizNetwork</h2>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">9.2.1 Data Preparation</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Preparation- Nodes &amp; Edges</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">

</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="sourceCode" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Clean and Prepare Nodes ---</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> mc3_nodes_raw <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rename 'type' to 'supertype' to reduce confusion with communication type</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">supertype =</span> type) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only columns that are needed and are consistently present</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name, sub_type, content, timestamp) <span class="co"># Keep timestamp as character for now</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Clean and Prepare Edges ---</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename 'type' in edges to 'edge_type' to avoid conflict with node 'supertype'</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges_raw <span class="sc">%&gt;%</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_id =</span> target,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">edge_type =</span> type) <span class="sc">%&gt;%</span> <span class="co"># Renamed 'type' to 'edge_type'</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id), as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out any edges where from_id or to_id are not in cleaned nodes</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. Identify Nadia Conti's ID and Sub_type ---</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>nadia_info <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, sub_type) <span class="co"># Corrected: Select sub_type here, not supertype</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>nadia_id <span class="ot">&lt;-</span> nadia_info <span class="sc">%&gt;%</span> <span class="fu">pull</span>(id)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>nadia_sub_type <span class="ot">&lt;-</span> nadia_info <span class="sc">%&gt;%</span> <span class="fu">pull</span>(sub_type) <span class="co"># New variable for Nadia's sub_type</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(nadia_id) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Nadia Conti not found in the nodes data. Please check the 'name' column or the ID."</span>)</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">length</span>(nadia_id) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Multiple entries found for Nadia Conti. Using the first one."</span>)</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>  nadia_id <span class="ot">&lt;-</span> nadia_id[<span class="dv">1</span>]</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>  nadia_sub_type <span class="ot">&lt;-</span> nadia_sub_type[<span class="dv">1</span>] <span class="co"># Ensure sub_type is also taken for the first one</span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Nadia Conti's ID:"</span>, nadia_id))</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Nadia Conti's Sub_type:"</span>, nadia_sub_type))</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 5. Extract Nadia's Sent Communications ---</span></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Logic: Nadia (source) --sent--&gt; Event_Communication (target) --received--&gt; Recipient (target)</span></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>nadia_sent_communications <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">==</span> nadia_id, edge_type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with nodes to get content and timestamp of the Event_Communication node</span></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, content, timestamp),</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">event_id =</span> to_id, <span class="at">event_content =</span> content, <span class="at">event_timestamp =</span> timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, find the recipient of this communication event</span></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(edge_type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(<span class="at">event_id_match =</span> from_id, <span class="at">recipient_id =</span> to_id),</span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"event_id"</span> <span class="ot">=</span> <span class="st">"event_id_match"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with nodes to get the recipient's name AND sub_type</span></span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, name, sub_type), <span class="co"># Select sub_type here</span></span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"recipient_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">recipient_name =</span> name, <span class="at">recipient_sub_type =</span> sub_type) <span class="sc">%&gt;%</span> <span class="co"># Rename sub_type</span></span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select and rename final columns for sent communications</span></span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">communication_type =</span> edge_type, <span class="co"># This will be "sent"</span></span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_id =</span> from_id,</span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a>    recipient_id,</span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a>    recipient_name,</span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a>    recipient_sub_type, <span class="co"># Include in final select</span></span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a>    event_id,</span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">content =</span> event_content,</span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> event_timestamp <span class="co"># Timestamp is still character here</span></span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_name =</span> <span class="sc">!!</span>nadia_id, <span class="co"># Explicitly set sender_name to Nadia's ID/name using !!</span></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_sub_type =</span> <span class="sc">!!</span>nadia_sub_type <span class="co"># Assign Nadia's sub_type as a constant value using !!</span></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"--- Nadia's Sent Communications ---"</span>)</span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(nadia_sent_communications, <span class="dv">10</span>), <span class="at">format =</span> <span class="st">"markdown"</span>, <span class="at">align =</span> <span class="st">"l"</span>))</span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 6. Extract Nadia's Received Communications ---</span></span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Logic: Sender (source) --sent--&gt; Event_Communication (target) --received--&gt; Nadia (target)</span></span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a>nadia_received_communications <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to_id <span class="sc">==</span> nadia_id, edge_type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The source of this edge is the Event_Communication node</span></span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">event_id =</span> from_id) <span class="sc">%&gt;%</span></span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with nodes to get content and timestamp of the Event_Communication node</span></span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, content, timestamp),</span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"event_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">event_content =</span> content, <span class="at">event_timestamp =</span> timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, find the original sender of this communication event</span></span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(edge_type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(<span class="at">event_id_match =</span> to_id, <span class="at">sender_id =</span> from_id),</span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"event_id"</span> <span class="ot">=</span> <span class="st">"event_id_match"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with nodes to get the sender's name AND sub_type</span></span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, name, sub_type), <span class="co"># Select sub_type here</span></span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sender_name =</span> name, <span class="at">sender_sub_type =</span> sub_type) <span class="sc">%&gt;%</span> <span class="co"># Rename sub_type</span></span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select and rename final columns for received communications</span></span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">communication_type =</span> edge_type, <span class="co"># This will be "received"</span></span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a>    sender_id,</span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a>    sender_name,</span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a>    sender_sub_type, <span class="co"># Include in final select</span></span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">recipient_id =</span> to_id,</span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a>    event_id,</span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">content =</span> event_content,</span>
<span id="cb49-107"><a href="#cb49-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> event_timestamp</span>
<span id="cb49-108"><a href="#cb49-108" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-109"><a href="#cb49-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-110"><a href="#cb49-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">recipient_name =</span> <span class="sc">!!</span>nadia_id, <span class="co"># Explicitly set recipient_name to Nadia's ID/name using !!</span></span>
<span id="cb49-111"><a href="#cb49-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">recipient_sub_type =</span> <span class="sc">!!</span>nadia_sub_type <span class="co"># Assign Nadia's sub_type as a constant value using !!</span></span>
<span id="cb49-112"><a href="#cb49-112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-113"><a href="#cb49-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-114"><a href="#cb49-114" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"--- Nadia's Received Communications ---"</span>)</span>
<span id="cb49-115"><a href="#cb49-115" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(nadia_received_communications, <span class="dv">10</span>), <span class="at">format =</span> <span class="st">"markdown"</span>, <span class="at">align =</span> <span class="st">"l"</span>))</span>
<span id="cb49-116"><a href="#cb49-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-117"><a href="#cb49-117" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 7. Combine Sent and Received Communications for Full Timeline ---</span></span>
<span id="cb49-118"><a href="#cb49-118" aria-hidden="true" tabindex="-1"></a>nadia_full_communications_timeline <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb49-119"><a href="#cb49-119" aria-hidden="true" tabindex="-1"></a>  nadia_sent_communications,</span>
<span id="cb49-120"><a href="#cb49-120" aria-hidden="true" tabindex="-1"></a>  nadia_received_communications</span>
<span id="cb49-121"><a href="#cb49-121" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb49-122"><a href="#cb49-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb49-123"><a href="#cb49-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># CRITICAL FIX: Explicitly convert timestamp to POSIXct after bind_rows</span></span>
<span id="cb49-124"><a href="#cb49-124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use as.POSIXct with the observed format string</span></span>
<span id="cb49-125"><a href="#cb49-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">as.POSIXct</span>(timestamp, <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-126"><a href="#cb49-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># NEW: Create a sorted communicating pair for consistent coloring</span></span>
<span id="cb49-127"><a href="#cb49-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> <span class="co"># Process row by row</span></span>
<span id="cb49-128"><a href="#cb49-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">communicating_pair_sorted =</span> <span class="fu">paste</span>(<span class="fu">sort</span>(<span class="fu">c</span>(sender_name, recipient_name)), <span class="at">collapse =</span> <span class="st">"_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-129"><a href="#cb49-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="co"># Return to normal data frame operations</span></span>
<span id="cb49-130"><a href="#cb49-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-131"><a href="#cb49-131" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"--- Nadia's Full Communication Timeline (Combined) ---"</span>)</span>
<span id="cb49-132"><a href="#cb49-132" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(nadia_full_communications_timeline, <span class="dv">10</span>), <span class="at">format =</span> <span class="st">"markdown"</span>, <span class="at">align =</span> <span class="st">"l"</span>))</span>
<span id="cb49-133"><a href="#cb49-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-134"><a href="#cb49-134" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 8. Prepare Data for Ego Network Visualization (Direct Person-to-Person/Entity) ---</span></span>
<span id="cb49-135"><a href="#cb49-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Build nodes and edges directly from nadia_full_communications_timeline,</span></span>
<span id="cb49-136"><a href="#cb49-136" aria-hidden="true" tabindex="-1"></a><span class="co"># focusing on direct sender-recipient connections.</span></span>
<span id="cb49-137"><a href="#cb49-137" aria-hidden="true" tabindex="-1"></a><span class="co"># Nodes for the ego network graph: Collect all unique sender and recipient IDs</span></span>
<span id="cb49-138"><a href="#cb49-138" aria-hidden="true" tabindex="-1"></a>all_ego_person_entity_ids <span class="ot">&lt;-</span> nadia_full_communications_timeline <span class="sc">%&gt;%</span></span>
<span id="cb49-139"><a href="#cb49-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id =</span> sender_id) <span class="sc">%&gt;%</span></span>
<span id="cb49-140"><a href="#cb49-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(nadia_full_communications_timeline <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">id =</span> recipient_id)) <span class="sc">%&gt;%</span></span>
<span id="cb49-141"><a href="#cb49-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb49-142"><a href="#cb49-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="co"># Ensure no NA IDs</span></span>
<span id="cb49-143"><a href="#cb49-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-144"><a href="#cb49-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter mc3_nodes_cleaned to get attributes for these person/entity nodes</span></span>
<span id="cb49-145"><a href="#cb49-145" aria-hidden="true" tabindex="-1"></a>ego_nodes_for_graph <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb49-146"><a href="#cb49-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> all_ego_person_entity_ids<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb49-147"><a href="#cb49-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span> <span class="co"># Ensure no NA IDs in nodes for graph</span></span>
<span id="cb49-148"><a href="#cb49-148" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add attributes for visualization</span></span>
<span id="cb49-149"><a href="#cb49-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-150"><a href="#cb49-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_nadia =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> nadia_id, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb49-151"><a href="#cb49-151" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a new column for legend grouping that includes Nadia as a distinct category</span></span>
<span id="cb49-152"><a href="#cb49-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">node_legend_group =</span> <span class="fu">ifelse</span>(is_nadia, <span class="st">"Nadia Conti"</span>, sub_type),</span>
<span id="cb49-153"><a href="#cb49-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">node_size =</span> <span class="fu">ifelse</span>(is_nadia, <span class="dv">20</span>, <span class="dv">18</span>), <span class="co"># Further increased node sizes: Nadia 20, others 10</span></span>
<span id="cb49-154"><a href="#cb49-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">display_name =</span> <span class="fu">ifelse</span>(is_nadia, <span class="st">"Nadia Conti"</span>, name) <span class="co"># Use actual name for others</span></span>
<span id="cb49-155"><a href="#cb49-155" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-156"><a href="#cb49-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sub_type)) <span class="co"># Ensure nodes have a sub_type for consistent plotting</span></span>
<span id="cb49-157"><a href="#cb49-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-158"><a href="#cb49-158" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate communication counts for each node for hover text</span></span>
<span id="cb49-159"><a href="#cb49-159" aria-hidden="true" tabindex="-1"></a>node_comm_summary <span class="ot">&lt;-</span> nadia_full_communications_timeline <span class="sc">%&gt;%</span></span>
<span id="cb49-160"><a href="#cb49-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">id =</span> sender_id) <span class="sc">%&gt;%</span></span>
<span id="cb49-161"><a href="#cb49-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sent_count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-162"><a href="#cb49-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(nadia_full_communications_timeline <span class="sc">%&gt;%</span></span>
<span id="cb49-163"><a href="#cb49-163" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(<span class="at">id =</span> recipient_id) <span class="sc">%&gt;%</span></span>
<span id="cb49-164"><a href="#cb49-164" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarise</span>(<span class="at">received_count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>),</span>
<span id="cb49-165"><a href="#cb49-165" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-166"><a href="#cb49-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-167"><a href="#cb49-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">sent_count =</span> <span class="fu">replace_na</span>(sent_count, <span class="dv">0</span>),</span>
<span id="cb49-168"><a href="#cb49-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">received_count =</span> <span class="fu">replace_na</span>(received_count, <span class="dv">0</span>)</span>
<span id="cb49-169"><a href="#cb49-169" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-170"><a href="#cb49-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-171"><a href="#cb49-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Join communication summary and create hover text for nodes</span></span>
<span id="cb49-172"><a href="#cb49-172" aria-hidden="true" tabindex="-1"></a>ego_nodes_for_graph <span class="ot">&lt;-</span> ego_nodes_for_graph <span class="sc">%&gt;%</span></span>
<span id="cb49-173"><a href="#cb49-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_comm_summary, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-174"><a href="#cb49-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-175"><a href="#cb49-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">hover_text =</span> <span class="fu">paste</span>(</span>
<span id="cb49-176"><a href="#cb49-176" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Name:"</span>, display_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb49-177"><a href="#cb49-177" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Type:"</span>, node_legend_group, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb49-178"><a href="#cb49-178" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sent Communications:"</span>, sent_count, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb49-179"><a href="#cb49-179" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Received Communications:"</span>, received_count</span>
<span id="cb49-180"><a href="#cb49-180" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-181"><a href="#cb49-181" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-182"><a href="#cb49-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-183"><a href="#cb49-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Edges for the ego network graph: Direct Sender -&gt; Recipient edges</span></span>
<span id="cb49-184"><a href="#cb49-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to count occurrences for edge thickness</span></span>
<span id="cb49-185"><a href="#cb49-185" aria-hidden="true" tabindex="-1"></a>ego_edges_for_graph <span class="ot">&lt;-</span> nadia_full_communications_timeline <span class="sc">%&gt;%</span></span>
<span id="cb49-186"><a href="#cb49-186" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group by sender, recipient, their names, and communication type to count interactions</span></span>
<span id="cb49-187"><a href="#cb49-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">from =</span> sender_id, <span class="at">to =</span> recipient_id, sender_name, recipient_name, communication_type) <span class="sc">%&gt;%</span></span>
<span id="cb49-188"><a href="#cb49-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-189"><a href="#cb49-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">count_of_comm =</span> <span class="fu">n</span>(), <span class="co"># Number of times this specific communication happened</span></span>
<span id="cb49-190"><a href="#cb49-190" aria-hidden="true" tabindex="-1"></a>    <span class="at">content_sample =</span> <span class="fu">paste</span>(<span class="fu">head</span>(content, <span class="dv">1</span>), <span class="at">collapse =</span> <span class="st">"; "</span>), <span class="co"># Sample content</span></span>
<span id="cb49-191"><a href="#cb49-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp_min =</span> <span class="fu">min</span>(timestamp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-192"><a href="#cb49-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp_max =</span> <span class="fu">max</span>(timestamp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-193"><a href="#cb49-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb49-194"><a href="#cb49-194" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-195"><a href="#cb49-195" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the 'nadia_role_in_comm' column for coloring based on Nadia's perspective</span></span>
<span id="cb49-196"><a href="#cb49-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-197"><a href="#cb49-197" aria-hidden="true" tabindex="-1"></a>    <span class="at">nadia_role_in_comm =</span> <span class="fu">case_when</span>(</span>
<span id="cb49-198"><a href="#cb49-198" aria-hidden="true" tabindex="-1"></a>      from <span class="sc">==</span> nadia_id <span class="sc">&amp;</span> communication_type <span class="sc">==</span> <span class="st">"sent"</span> <span class="sc">~</span> <span class="st">"Nadia Sent"</span>,</span>
<span id="cb49-199"><a href="#cb49-199" aria-hidden="true" tabindex="-1"></a>      to <span class="sc">==</span> nadia_id <span class="sc">&amp;</span> communication_type <span class="sc">==</span> <span class="st">"received"</span> <span class="sc">~</span> <span class="st">"Nadia Received"</span>,</span>
<span id="cb49-200"><a href="#cb49-200" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other Communication"</span> <span class="co"># For communications not directly involving Nadia as sender/recipient</span></span>
<span id="cb49-201"><a href="#cb49-201" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-202"><a href="#cb49-202" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-203"><a href="#cb49-203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure 'from' and 'to' are character and non-NA</span></span>
<span id="cb49-204"><a href="#cb49-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-205"><a href="#cb49-205" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">as.character</span>(from),</span>
<span id="cb49-206"><a href="#cb49-206" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">as.character</span>(to)</span>
<span id="cb49-207"><a href="#cb49-207" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-208"><a href="#cb49-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to)) <span class="sc">%&gt;%</span></span>
<span id="cb49-209"><a href="#cb49-209" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out edges where 'from' or 'to' IDs are NOT in the final ego_nodes_for_graph</span></span>
<span id="cb49-210"><a href="#cb49-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> ego_nodes_for_graph<span class="sc">$</span>id, to <span class="sc">%in%</span> ego_nodes_for_graph<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb49-211"><a href="#cb49-211" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create hover text for edges</span></span>
<span id="cb49-212"><a href="#cb49-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-213"><a href="#cb49-213" aria-hidden="true" tabindex="-1"></a>    <span class="at">hover_text =</span> <span class="fu">paste</span>(</span>
<span id="cb49-214"><a href="#cb49-214" aria-hidden="true" tabindex="-1"></a>      <span class="st">"From:"</span>, sender_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb49-215"><a href="#cb49-215" aria-hidden="true" tabindex="-1"></a>      <span class="st">"To:"</span>, recipient_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb49-216"><a href="#cb49-216" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Type:"</span>, communication_type, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb49-217"><a href="#cb49-217" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Count:"</span>, count_of_comm, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb49-218"><a href="#cb49-218" aria-hidden="true" tabindex="-1"></a>      <span class="st">"First:"</span>, <span class="fu">format</span>(timestamp_min, <span class="st">"%Y-%m-%d %H:%M:%S"</span>), <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb49-219"><a href="#cb49-219" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Last:"</span>, <span class="fu">format</span>(timestamp_max, <span class="st">"%Y-%m-%d %H:%M:%S"</span>), <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb49-220"><a href="#cb49-220" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Content Sample:"</span>, content_sample</span>
<span id="cb49-221"><a href="#cb49-221" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-222"><a href="#cb49-222" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-223"><a href="#cb49-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-224"><a href="#cb49-224" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the tbl_graph object for the ego network</span></span>
<span id="cb49-225"><a href="#cb49-225" aria-hidden="true" tabindex="-1"></a>nadia_ego_network_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> ego_nodes_for_graph, <span class="at">edges =</span> ego_edges_for_graph, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-226"><a href="#cb49-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-227"><a href="#cb49-227" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"--- Checking: Number of nodes and edges in Nadia's Ego Network Graph ---"</span>)</span>
<span id="cb49-228"><a href="#cb49-228" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Nodes:"</span>, <span class="fu">gorder</span>(nadia_ego_network_graph), <span class="st">"Edges:"</span>, <span class="fu">gsize</span>(nadia_ego_network_graph)))</span>
<span id="cb49-229"><a href="#cb49-229" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"---------------------------------------------------------------------"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="nadias-sent-and-received-ego-networks" class="level3">
<h3 class="anchored" data-anchor-id="nadias-sent-and-received-ego-networks">9.2.2 Nadiaâ€™s Sent and Received Ego Networks</h3>
</section>
<section id="sent-communications-network" class="level3">
<h3 class="anchored" data-anchor-id="sent-communications-network">9.2.2.1 Sent Communications Network</h3>
<div class="no-code-fold">

</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define custom colors for node types (reusing from previous code)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>node_legend_colors_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"#88CCEE"</span>,      <span class="co"># Blue</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,      <span class="co"># Orange</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"#117733"</span>, <span class="co"># Green</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"#AA4499"</span>,   <span class="co"># Purple</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Nadia Conti"</span> <span class="ot">=</span> <span class="st">"red"</span>      <span class="co"># Special color for Nadia</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define custom shapes for node subtypes</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>node_legend_shapes_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"dot"</span>,        <span class="co"># Circle for visNetwork</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"triangle"</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"square"</span>,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"diamond"</span>,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Nadia Conti"</span> <span class="ot">=</span> <span class="st">"star"</span>   <span class="co"># Star shape for Nadia in visNetwork</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate the edges into two sets: Nadia Sent and Nadia Received</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>edges_sent <span class="ot">&lt;-</span> ego_edges_for_graph <span class="sc">%&gt;%</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nadia_role_in_comm <span class="sc">==</span> <span class="st">"Nadia Sent"</span>)</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>edges_received <span class="ot">&lt;-</span> ego_edges_for_graph <span class="sc">%&gt;%</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nadia_role_in_comm <span class="sc">==</span> <span class="st">"Nadia Received"</span>)</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to build visNetwork plot for a given edge set</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>build_visnetwork_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(edge_df, title_label) {</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare nodes from edge list</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  node_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(edge_df<span class="sc">$</span>from, edge_df<span class="sc">$</span>to))</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  nodes <span class="ot">&lt;-</span> ego_nodes_for_graph <span class="sc">%&gt;%</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(id <span class="sc">%in%</span> node_ids) <span class="sc">%&gt;%</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">ifelse</span>(display_name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>, <span class="st">""</span>, display_name),</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste0</span>(</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;"</span>, display_name, <span class="st">"&lt;/b&gt;&lt;br&gt;"</span>,</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Type: "</span>, node_legend_group, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sent: "</span>, sent_count, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Received: "</span>, received_count</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="fu">ifelse</span>(display_name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>, <span class="st">"Nadia Conti"</span>, node_legend_group)</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(id, label, title, group, <span class="at">value =</span> node_size)</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare edges with arrow and tooltip</span></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>  edges <span class="ot">&lt;-</span> edge_df <span class="sc">%&gt;%</span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to)) <span class="sc">%&gt;%</span></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste0</span>(</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;From:&lt;/b&gt; "</span>, sender_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;To:&lt;/b&gt; "</span>, recipient_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;Type:&lt;/b&gt; "</span>, communication_type, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;Count:&lt;/b&gt; "</span>, count_of_comm, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;First:&lt;/b&gt; "</span>, <span class="fu">format</span>(timestamp_min, <span class="st">"%Y-%m-%d %H:%M:%S"</span>), <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;Last:&lt;/b&gt; "</span>, <span class="fu">format</span>(timestamp_max, <span class="st">"%Y-%m-%d %H:%M:%S"</span>), <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Content Sample:&lt;/b&gt;&lt;br&gt;&lt;div style='max-width:300px;white-space:normal;'&gt;"</span>, content_sample, <span class="st">"&lt;/div&gt;"</span></span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(from, to, arrows, title, <span class="at">width =</span> count_of_comm)</span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create visNetwork</span></span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNetwork</span>(nodes, edges, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"600px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visEdges</span>(<span class="at">smooth =</span> <span class="cn">FALSE</span>, <span class="at">arrows =</span> <span class="fu">list</span>(<span class="at">to =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, <span class="at">scaleFactor =</span> <span class="fl">1.5</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visNodes</span>(<span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Person"</span>, <span class="at">color =</span> node_legend_colors_plot[[<span class="st">"Person"</span>]], <span class="at">shape =</span> node_legend_shapes_plot[[<span class="st">"Person"</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Vessel"</span>, <span class="at">color =</span> node_legend_colors_plot[[<span class="st">"Vessel"</span>]], <span class="at">shape =</span> node_legend_shapes_plot[[<span class="st">"Vessel"</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Organization"</span>, <span class="at">color =</span> node_legend_colors_plot[[<span class="st">"Organization"</span>]], <span class="at">shape =</span> node_legend_shapes_plot[[<span class="st">"Organization"</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Location"</span>, <span class="at">color =</span> node_legend_colors_plot[[<span class="st">"Location"</span>]], <span class="at">shape =</span> node_legend_shapes_plot[[<span class="st">"Location"</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Nadia Conti"</span>, <span class="at">color =</span> node_legend_colors_plot[[<span class="st">"Nadia Conti"</span>]], <span class="at">shape =</span> node_legend_shapes_plot[[<span class="st">"Nadia Conti"</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">visLegend</span>(</span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> legend_df,</span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"left"</span>,</span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Entity (Sub)Types"</span>,</span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a>    visNetwork<span class="sc">::</span><span class="fu">visExport</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a>    visNetwork<span class="sc">::</span><span class="fu">visPhysics</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a>    visNetwork<span class="sc">::</span><span class="fu">visInteraction</span>(<span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a>    visNetwork<span class="sc">::</span><span class="fu">visEvents</span>(<span class="at">stabilizationIterationsDone =</span> <span class="st">"function () {this.setOptions({physics:false});}"</span>)</span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-85"><a href="#cb50-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-86"><a href="#cb50-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Build and show visNetwork plots</span></span>
<span id="cb50-87"><a href="#cb50-87" aria-hidden="true" tabindex="-1"></a><span class="fu">build_visnetwork_plot</span>(edges_sent, <span class="st">"Nadia Sent Ego Network"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="received-communications-network" class="level3">
<h3 class="anchored" data-anchor-id="received-communications-network">9.2.2.2 Received Communications Network</h3>
<div class="no-code-fold">

</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">build_visnetwork_plot</span>(edges_received, <span class="st">"Nadia Received Ego Network"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="findings-5" class="level3">
<h3 class="anchored" data-anchor-id="findings-5"><strong>9.2.3 Findings</strong>:</h3>
<p>We then wanted to find more about the correspondences. The first graph illustrated Nadiaâ€™s sent communications and the second graph were her received communications. Hover over nodes to see the sent or received count from the perspective of the entity. Hover over arrowheads to see the number, direction, count, first and last correspondence time, type of sent or received, and content of one communication. Nadia sent only 8 but received 18 communications (possibly indicative of using a pseudonym):</p>
<ul>
<li><p>Nodes involved: Nadia, Davis, Elise, Haacklee Habor, Liam, Marlin, Neptune, Oceanus City Council, Remora, Rodriguez, Sailor Shifts Team, Sentinel, V. Miesel Shipping.</p></li>
<li><p>Sent more direct communications to Liam (2) and Neptune (2), relative to others.</p></li>
<li><p>Received more from Davis (5), Elise (3), and Liam (2), relative to others.</p></li>
<li><p>The next step would be to find out the suspicious characters/ activities.</p></li>
</ul>
</section>
</section>
<section id="nadias-ego-network-3-hops-degree-centrality" class="level2">
<h2 class="anchored" data-anchor-id="nadias-ego-network-3-hops-degree-centrality">9.3 Nadiaâ€™s Ego Network: 3-hops degree centrality</h2>
<p>To uncover more details, we designed n-hops degree centrality here. We input 3 hops to hover over the nodes and look into the communications in a wider network. 3-hop exposes overlapping communites (Nadia communicating with someone who coordinates between groups). The â€œbridgesâ€ may show their value in 3-hops. It also increases the change of detecting complete or near complete cliques. We understand that should there be requirements for details, we could look into n-hops and more.</p>
<div class="no-code-fold">

</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Define event and relationship subtypes (optional, for filtering or labeling) ---</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>event_subtypes <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Communication"</span>, <span class="st">"Monitoring"</span>, <span class="st">"VesselMovement"</span>, <span class="st">"Assessment"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Collaborate"</span>, <span class="st">"Endorsement"</span>, <span class="st">"TourActivity"</span>, <span class="st">"TransponderPing"</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Harbor Report"</span>, <span class="st">"Fishing"</span>, <span class="st">"Criticize"</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>relationship_subtypes <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coordinates"</span>, <span class="st">"AccessPermission"</span>, <span class="st">"Operates"</span>, <span class="st">"Colleagues"</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Suspicious"</span>, <span class="st">"Reports"</span>, <span class="st">"Jurisdiction"</span>, <span class="st">"Unfriendly"</span>, <span class="st">"Friends"</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Define node colors and shapes by type or key sub-type ---</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>node_legend_colors_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"#88CCEE"</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"#117733"</span>,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"#AA4499"</span>,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Group"</span> <span class="ot">=</span> <span class="st">"#CC79A7"</span>,</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event"</span> <span class="ot">=</span> <span class="st">"#DDCC77"</span>,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relationship"</span> <span class="ot">=</span> <span class="st">"#AF8DC3"</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>node_legend_shapes_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"dot"</span>,</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"triangle"</span>,</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"square"</span>,</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"diamond"</span>,</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Group"</span> <span class="ot">=</span> <span class="st">"circle"</span>,</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event"</span> <span class="ot">=</span> <span class="st">"star"</span>,</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relationship"</span> <span class="ot">=</span> <span class="st">"square"</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>STYLES <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">node_label_dark =</span> <span class="st">"black"</span>,</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">font_family =</span> <span class="st">"Roboto Condensed"</span></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 2. Define function to extract ego subgraph ----</span></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>extract_ego_subgraph <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">center_node =</span> <span class="st">"Nadia Conti"</span>, <span class="at">hops =</span> <span class="dv">3</span>) {</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct igraph object</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(</span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> mc3_edges_final <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">from =</span> from_id, <span class="at">to =</span> to_id),</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertices =</span> mc3_nodes_final <span class="sc">%&gt;%</span> <span class="fu">select</span>(id) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">name =</span> id),</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract ego network</span></span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>  ego_graph <span class="ot">&lt;-</span> <span class="fu">make_ego_graph</span>(g, <span class="at">order =</span> hops, <span class="at">nodes =</span> center_node, <span class="at">mode =</span> <span class="st">"all"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>  node_ids <span class="ot">&lt;-</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>name</span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>  edge_df <span class="ot">&lt;-</span> <span class="fu">as_data_frame</span>(ego_graph, <span class="at">what =</span> <span class="st">"edges"</span>)</span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare node metadata for visNetwork</span></span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>  ego_nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(id <span class="sc">%in%</span> node_ids) <span class="sc">%&gt;%</span></span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(name), id, name),</span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">tooltip_extra =</span> <span class="fu">case_when</span>(</span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>        type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Communication"</span> <span class="sc">~</span> content,</span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>        type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Monitoring"</span> <span class="sc">~</span> findings,</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>        type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"VesselMovement"</span> <span class="sc">~</span> destination,</span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>        type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Assessment"</span> <span class="sc">~</span> results,</span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>        type <span class="sc">==</span> <span class="st">"Relationship"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Coordinates"</span> <span class="sc">~</span> coordination_type,</span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a>        type <span class="sc">==</span> <span class="st">"Relationship"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Operates"</span> <span class="sc">~</span> operational_role,</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>        type <span class="sc">==</span> <span class="st">"Relationship"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Jurisdiction"</span> <span class="sc">~</span> jurisdiction_type,</span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste0</span>(</span>
<span id="cb52-69"><a href="#cb52-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;"</span>, label, <span class="st">"&lt;/b&gt;&lt;br&gt;"</span>,</span>
<span id="cb52-70"><a href="#cb52-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Type: "</span>, type, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sub-type: "</span>, sub_type, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(tooltip_extra), <span class="fu">paste0</span>(<span class="st">"&lt;br&gt;&lt;b&gt;Details:&lt;/b&gt; "</span>, tooltip_extra), <span class="st">""</span>)</span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a>        sub_type <span class="sc">%in%</span> <span class="fu">names</span>(node_legend_colors_plot) <span class="sc">~</span> sub_type,</span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>        type <span class="sc">%in%</span> <span class="fu">names</span>(node_legend_colors_plot) <span class="sc">~</span> type,</span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb52-80"><a href="#cb52-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(id, label, group, title) <span class="sc">%&gt;%</span></span>
<span id="cb52-81"><a href="#cb52-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-82"><a href="#cb52-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-83"><a href="#cb52-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">nodes =</span> ego_nodes, <span class="at">edges =</span> edge_df)</span>
<span id="cb52-84"><a href="#cb52-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-85"><a href="#cb52-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-86"><a href="#cb52-86" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 3. Extract Nadia Conti's 3-hop ego network ----</span></span>
<span id="cb52-87"><a href="#cb52-87" aria-hidden="true" tabindex="-1"></a>ego_data <span class="ot">&lt;-</span> <span class="fu">extract_ego_subgraph</span>(<span class="st">"Nadia Conti"</span>, <span class="at">hops =</span> <span class="dv">3</span>)</span>
<span id="cb52-88"><a href="#cb52-88" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> ego_data<span class="sc">$</span>nodes</span>
<span id="cb52-89"><a href="#cb52-89" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> ego_data<span class="sc">$</span>edges</span>
<span id="cb52-90"><a href="#cb52-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-91"><a href="#cb52-91" aria-hidden="true" tabindex="-1"></a><span class="co"># (Optional) Save output</span></span>
<span id="cb52-92"><a href="#cb52-92" aria-hidden="true" tabindex="-1"></a>nadia_ego_nodes_2hop <span class="ot">&lt;-</span> nodes</span>
<span id="cb52-93"><a href="#cb52-93" aria-hidden="true" tabindex="-1"></a>nadia_ego_edges_2hop <span class="ot">&lt;-</span> edges</span>
<span id="cb52-94"><a href="#cb52-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-95"><a href="#cb52-95" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 4. Build visNetwork plot ----</span></span>
<span id="cb52-96"><a href="#cb52-96" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes, edges, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"600px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-97"><a href="#cb52-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="fu">list</span>(<span class="at">to =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, <span class="at">scaleFactor =</span> <span class="fl">1.5</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb52-98"><a href="#cb52-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-99"><a href="#cb52-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-100"><a href="#cb52-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">font =</span> <span class="fu">list</span>(</span>
<span id="cb52-101"><a href="#cb52-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb52-102"><a href="#cb52-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> STYLES<span class="sc">$</span>node_label_dark,</span>
<span id="cb52-103"><a href="#cb52-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">face =</span> STYLES<span class="sc">$</span>font_family,</span>
<span id="cb52-104"><a href="#cb52-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">vadjust =</span> <span class="sc">-</span><span class="dv">15</span></span>
<span id="cb52-105"><a href="#cb52-105" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb52-106"><a href="#cb52-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-107"><a href="#cb52-107" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 5. Apply color/shape for known groups ----</span></span>
<span id="cb52-108"><a href="#cb52-108" aria-hidden="true" tabindex="-1"></a>used_groups <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">unique</span>(nodes<span class="sc">$</span>group), <span class="fu">names</span>(node_legend_colors_plot))</span>
<span id="cb52-109"><a href="#cb52-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-110"><a href="#cb52-110" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (group_name <span class="cf">in</span> used_groups) {</span>
<span id="cb52-111"><a href="#cb52-111" aria-hidden="true" tabindex="-1"></a>  net <span class="ot">&lt;-</span> net <span class="sc">%&gt;%</span> <span class="fu">visGroups</span>(</span>
<span id="cb52-112"><a href="#cb52-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">groupname =</span> group_name,</span>
<span id="cb52-113"><a href="#cb52-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> node_legend_colors_plot[[group_name]],</span>
<span id="cb52-114"><a href="#cb52-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> node_legend_shapes_plot[[group_name]]</span>
<span id="cb52-115"><a href="#cb52-115" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-116"><a href="#cb52-116" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-117"><a href="#cb52-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-118"><a href="#cb52-118" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 6. Add legend dynamically ----</span></span>
<span id="cb52-119"><a href="#cb52-119" aria-hidden="true" tabindex="-1"></a>legend_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb52-120"><a href="#cb52-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> used_groups,</span>
<span id="cb52-121"><a href="#cb52-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> node_legend_shapes_plot[used_groups],</span>
<span id="cb52-122"><a href="#cb52-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> node_legend_colors_plot[used_groups]</span>
<span id="cb52-123"><a href="#cb52-123" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb52-124"><a href="#cb52-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(label, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-125"><a href="#cb52-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-126"><a href="#cb52-126" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> net <span class="sc">%&gt;%</span> <span class="fu">visLegend</span>(</span>
<span id="cb52-127"><a href="#cb52-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">addNodes =</span> legend_df,</span>
<span id="cb52-128"><a href="#cb52-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb52-129"><a href="#cb52-129" aria-hidden="true" tabindex="-1"></a>  <span class="at">position =</span> <span class="st">"left"</span>,</span>
<span id="cb52-130"><a href="#cb52-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Entity (Sub)Types"</span>,</span>
<span id="cb52-131"><a href="#cb52-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">useGroups =</span> <span class="cn">FALSE</span></span>
<span id="cb52-132"><a href="#cb52-132" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-133"><a href="#cb52-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-134"><a href="#cb52-134" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 7. Render the network ----</span></span>
<span id="cb52-135"><a href="#cb52-135" aria-hidden="true" tabindex="-1"></a>net</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="findings-6" class="level4">
<h4 class="anchored" data-anchor-id="findings-6"><strong>9.3.1 Findings</strong>:</h4>
<ul>
<li><p>Nodes from 1-hop: Nadia, Davis, Elise, Haacklee Habor, Liam, Marlin, Neptune, Oceanus City Council, Remora, Rodriguez, Sailor Shifts Team, Sentinel, V. Miesel Shipping.</p></li>
<li><p>Additional nodes from 3-hop: Conservation vessels, EcoVigil, Sam, The Accountant, Mako, Nemo Reef.</p></li>
<li><p>We would then use these 3-hop nodes to drill in deeper to find suspicious relationships between nodes.</p></li>
</ul>
</section>
</section>
</section>
<section id="question-4b" class="level1">
<h1>Question 4b)</h1>
<section id="summary-of-nadias-actions" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-nadias-actions"><strong>9.4 Summary of Nadiaâ€™s Actions</strong></h2>
<section id="sequential-timeline-in-table-3-hop" class="level3">
<h3 class="anchored" data-anchor-id="sequential-timeline-in-table-3-hop">9.4.1 Sequential Timeline in Table (3-hop)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">The Suspicious Entities</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">The Code</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">

</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="sourceCode" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Nadia Conti's 3-hop ego network</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 1: Create igraph from edge list ----</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> mc3_edges_final <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">from =</span> from_id, <span class="at">to =</span> to_id),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertices =</span> mc3_nodes_final <span class="sc">%&gt;%</span> <span class="fu">select</span>(id) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">name =</span> id),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 2: Extract 3-hop ego network for Nadia Conti ----</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>ego_graph <span class="ot">&lt;-</span> <span class="fu">make_ego_graph</span>(g, <span class="at">order =</span> <span class="dv">3</span>, <span class="at">nodes =</span> <span class="st">"Nadia Conti"</span>, <span class="at">mode =</span> <span class="st">"all"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>node_ids <span class="ot">&lt;-</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>name</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>edge_df <span class="ot">&lt;-</span> <span class="fu">as_data_frame</span>(ego_graph, <span class="at">what =</span> <span class="st">"edges"</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 3: Enrich ego nodes with labels and metadata ----</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>nadia_ego_nodes_3hop <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> node_ids) <span class="sc">%&gt;%</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(name), id, name),</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip_extra =</span> <span class="fu">case_when</span>(</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Communication"</span> <span class="sc">~</span> content,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Monitoring"</span> <span class="sc">~</span> findings,</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"VesselMovement"</span> <span class="sc">~</span> destination,</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Event"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Assessment"</span> <span class="sc">~</span> results,</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Relationship"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Coordinates"</span> <span class="sc">~</span> coordination_type,</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Relationship"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Operates"</span> <span class="sc">~</span> operational_role,</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Relationship"</span> <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Jurisdiction"</span> <span class="sc">~</span> jurisdiction_type,</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 4: Enrich edges with sender/recipient names and types ----</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>nadia_ego_edges_3hop <span class="ot">&lt;-</span> edge_df <span class="sc">%&gt;%</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nadia_ego_nodes_3hop <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">sender_name =</span> label, <span class="at">sender_sub_type =</span> sub_type), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nadia_ego_nodes_3hop <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">recipient_name =</span> label, <span class="at">recipient_sub_type =</span> sub_type), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 5: Create detailed communication dataframe ----</span></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>nadia_ego_comm_df_3hop <span class="ot">&lt;-</span> edge_df <span class="sc">%&gt;%</span></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>    nadia_ego_nodes_3hop <span class="sc">%&gt;%</span></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(id, name, sub_type),</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"id"</span>)</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_id =</span> from,</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_name =</span> name,</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_type =</span> sub_type</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>    nadia_ego_nodes_3hop <span class="sc">%&gt;%</span></span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(id, name, sub_type, content, findings, destination, results,</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>             coordination_type, operational_role, jurisdiction_type, timestamp),</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"id"</span>)</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">recipient_id =</span> to,</span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">recipient_name =</span> name,</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">recipient_type =</span> sub_type</span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">details =</span> <span class="fu">coalesce</span>(content, findings, destination, results,</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>                       coordination_type, operational_role, jurisdiction_type),</span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">suppressWarnings</span>(<span class="fu">ymd_hms</span>(timestamp))</span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>    sender_id, sender_name, sender_type,</span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>    recipient_id, recipient_name, recipient_type,</span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>    timestamp, details</span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 6: Filter for 'suspicious' in any relevant field ----</span></span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a>suspicious_links <span class="ot">&lt;-</span> nadia_ego_comm_df_3hop <span class="sc">%&gt;%</span></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"suspicious"</span>, sender_id, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">|</span></span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"suspicious"</span>, sender_type, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">|</span></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"suspicious"</span>, recipient_id, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">|</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"suspicious"</span>, recipient_type, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>    sender_id, sender_name, sender_type,</span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a>    recipient_id, recipient_name, recipient_type</span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 7: View suspicious interactions ----</span></span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a>unique_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(suspicious_links<span class="sc">$</span>sender_id, suspicious_links<span class="sc">$</span>recipient_id))</span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(unique_ids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>Elise, EcoVigil, Elise, Davis, Liam, Mako, Neptune, Sam, Remora, Rodriguez, Sailor Shifts Team, Sentinel, The Accountant, Oceanus City Council, V. Miesel Shipping possibly found something suspicious or were involved in something suspicious.</li>
</ul>
</section>
<section id="plotted-timeline-3-hop--only-suspicious-communications" class="level3">
<h3 class="anchored" data-anchor-id="plotted-timeline-3-hop--only-suspicious-communications">9.4.2 Plotted Timeline (3-hop)- Only suspicious communications</h3>
<p>These are the suspicious communications extracted from 9.4.1.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 1: Define fixed suspicious Event_Communication IDs ----</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>event_ids_to_extract <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_222"</span>, <span class="st">"Event_Communication_270"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_272"</span>, <span class="st">"Event_Communication_370"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_485"</span>, <span class="st">"Event_Communication_535"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_565"</span>, <span class="st">"Event_Communication_574"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_601"</span>, <span class="st">"Event_Communication_612"</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_639"</span>, <span class="st">"Event_Communication_677"</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_724"</span>, <span class="st">"Event_Communication_726"</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_753"</span>, <span class="st">"Event_Communication_761"</span>,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_833"</span>, <span class="st">"Event_Communication_916"</span>,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Event_Communication_951"</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 2: Match to master communication events ----</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>matched_comms_df <span class="ot">&lt;-</span> other_communications_df <span class="sc">%&gt;%</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(event_id <span class="sc">%in%</span> event_ids_to_extract)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 3: Prepare data for plotting ----</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>matched_comms_df_for_plot <span class="ot">&lt;-</span> matched_comms_df <span class="sc">%&gt;%</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">as.POSIXct</span>(timestamp),</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_date =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_time_of_day =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">format</span>(timestamp, <span class="st">"%H:%M:%S"</span>)),</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_sub_type =</span> <span class="fu">factor</span>(sender_sub_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>, <span class="st">"Organization"</span>, <span class="st">"Location"</span>)),</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">communicating_pair_sorted =</span> <span class="fu">paste</span>(<span class="fu">pmin</span>(sender_name, recipient_name), <span class="fu">pmax</span>(sender_name, recipient_name), <span class="at">sep =</span> <span class="st">" &amp; "</span>)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 4: Add tooltip labels ----</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> matched_comms_df_for_plot <span class="sc">%&gt;%</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">wrapped_content =</span> <span class="fu">str_wrap</span>(content, <span class="at">width =</span> <span class="dv">50</span>),</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip_text =</span> <span class="fu">paste0</span>(</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Date:&lt;/b&gt; "</span>, comm_date, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Time:&lt;/b&gt; "</span>, <span class="fu">format</span>(comm_time_of_day, <span class="st">"%H:%M:%S"</span>), <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Event ID:&lt;/b&gt; "</span>, event_id, <span class="st">"&lt;br&gt;&lt;br&gt;"</span>,</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;From:&lt;/b&gt; "</span>, sender_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;To:&lt;/b&gt; "</span>, recipient_name, <span class="st">"&lt;br&gt;&lt;br&gt;"</span>,</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Content:&lt;/b&gt;&lt;br&gt;"</span>, wrapped_content</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 5: Generate timeline plot ----</span></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> comm_date, <span class="at">y =</span> comm_time_of_day)) <span class="sc">+</span></span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> sender_name,</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> sender_sub_type,</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> tooltip_text</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">show.legend =</span> <span class="fu">c</span>(<span class="at">color =</span> <span class="cn">TRUE</span>, <span class="at">shape =</span> <span class="cn">FALSE</span>), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Person"</span> <span class="ot">=</span> <span class="dv">16</span>,</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="dv">17</span>,</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Organization"</span> <span class="ot">=</span> <span class="dv">15</span>,</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Location"</span> <span class="ot">=</span> <span class="dv">18</span></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_time</span>(</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"14:00:00"</span>)),</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"09:00:00"</span>, <span class="st">"10:00:00"</span>, <span class="st">"11:00:00"</span>, <span class="st">"12:00:00"</span>, <span class="st">"13:00:00"</span>, <span class="st">"14:00:00"</span>)),</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"08:00"</span>, <span class="st">"09:00"</span>, <span class="st">"10:00"</span>, <span class="st">"11:00"</span>, <span class="st">"12:00"</span>, <span class="st">"13:00"</span>, <span class="st">"14:00"</span>)</span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">"1 day"</span>,</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%d %b"</span></span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sender_sub_type, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"fixed"</span>) <span class="sc">+</span></span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Suspicious Communications Timeline (Nadia's 3-hop Ego Network)"</span>,</span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Sender"</span></span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>), <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-90"><a href="#cb54-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-91"><a href="#cb54-91" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 6: Convert to interactive plot ----</span></span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plotted-timeline-3-hop--full-communications" class="level3">
<h3 class="anchored" data-anchor-id="plotted-timeline-3-hop--full-communications">Plotted Timeline (3-hop)- Full communications</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 1: Extract Communication Event IDs from Nadia's 3-hop ego network ----</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>event_ids_to_extract <span class="ot">&lt;-</span> nadia_ego_comm_df_3hop <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_starts</span>(sender_id, <span class="st">"Event_Communication_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sender_id) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 2: Match to master communication events ----</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>matched_comms_df <span class="ot">&lt;-</span> other_communications_df <span class="sc">%&gt;%</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(event_id <span class="sc">%in%</span> event_ids_to_extract)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 3: Prepare data for plotting ----</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>matched_comms_df_for_plot <span class="ot">&lt;-</span> matched_comms_df <span class="sc">%&gt;%</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">as.POSIXct</span>(timestamp),</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_date =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_time_of_day =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">format</span>(timestamp, <span class="st">"%H:%M:%S"</span>)),</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_sub_type =</span> <span class="fu">factor</span>(sender_sub_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>, <span class="st">"Organization"</span>, <span class="st">"Location"</span>)),</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">communicating_pair_sorted =</span> <span class="fu">paste</span>(<span class="fu">pmin</span>(sender_name, recipient_name), <span class="fu">pmax</span>(sender_name, recipient_name), <span class="at">sep =</span> <span class="st">" &amp; "</span>)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 4: Add tooltip labels ----</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> matched_comms_df_for_plot <span class="sc">%&gt;%</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">wrapped_content =</span> <span class="fu">str_wrap</span>(content, <span class="at">width =</span> <span class="dv">50</span>),</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip_text =</span> <span class="fu">paste0</span>(</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Date:&lt;/b&gt; "</span>, comm_date, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Time:&lt;/b&gt; "</span>, <span class="fu">format</span>(comm_time_of_day, <span class="st">"%H:%M:%S"</span>), <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Event ID:&lt;/b&gt; "</span>, event_id, <span class="st">"&lt;br&gt;&lt;br&gt;"</span>,</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;From:&lt;/b&gt; "</span>, sender_name, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;To:&lt;/b&gt; "</span>, recipient_name, <span class="st">"&lt;br&gt;&lt;br&gt;"</span>,</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Content:&lt;/b&gt;&lt;br&gt;"</span>, wrapped_content</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 5: Generate timeline plot ----</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> comm_date, <span class="at">y =</span> comm_time_of_day)) <span class="sc">+</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> sender_name,</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> sender_sub_type,</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> tooltip_text</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">show.legend =</span> <span class="fu">c</span>(<span class="at">color =</span> <span class="cn">TRUE</span>, <span class="at">shape =</span> <span class="cn">FALSE</span>), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Person"</span> <span class="ot">=</span> <span class="dv">16</span>,</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="dv">17</span>,</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Organization"</span> <span class="ot">=</span> <span class="dv">15</span>,</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Location"</span> <span class="ot">=</span> <span class="dv">18</span></span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_time</span>(</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"14:00:00"</span>)),</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"09:00:00"</span>, <span class="st">"10:00:00"</span>, <span class="st">"11:00:00"</span>, <span class="st">"12:00:00"</span>, <span class="st">"13:00:00"</span>, <span class="st">"14:00:00"</span>)),</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"08:00"</span>, <span class="st">"09:00"</span>, <span class="st">"10:00"</span>, <span class="st">"11:00"</span>, <span class="st">"12:00"</span>, <span class="st">"13:00"</span>, <span class="st">"14:00"</span>)</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">"1 day"</span>,</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%d %b"</span></span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sender_sub_type, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"fixed"</span>) <span class="sc">+</span></span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nadia's 3-hop Communications Timeline (Sender Perspective)"</span>,</span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Sender"</span></span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>), <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 6: Convert to interactive plot ----</span></span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="discussioninterpretation-1-3-hop-data" class="level2">
<h2 class="anchored" data-anchor-id="discussioninterpretation-1-3-hop-data"><strong>9.5 Discussion/Interpretation (1 &amp; 3 hop data):</strong></h2>
<p>There were certain questions we posted to ourselves and came out with the answers.</p>
<section id="the-community-and-ego-network" class="level3">
<h3 class="anchored" data-anchor-id="the-community-and-ego-network">9.5.1 The Community and Ego Network:</h3>
<section id="question-and-answer-analysis" class="level4">
<h4 class="anchored" data-anchor-id="question-and-answer-analysis">Question and Answer Analysis</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 44%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Question</th>
<th style="text-align: left;">Answer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Who were Nadiaâ€™s direct communication contacts (1-hop degree centrality)? Are any of them known to be suspicious or involved in illicit activities?</td>
<td style="text-align: left;"><p>From the thicker width in the Ego network, it appeared that Nadia often communicated with <strong>Liam</strong>, <strong>Elise</strong>, and <strong>Davis</strong>.</p>
<p>Liam appeared to be The <strong>Middleman</strong> within Nadiaâ€™s direct community from the Louvain Community Network.</p>
<p>From the filtered table on suspicious relationships, <strong>Elise</strong>, <strong>Liam</strong>, <strong>EcoVigil</strong>, <strong>Sentinel</strong>, <strong>Oceanus City Council</strong>, and <strong>V. Miesel Shipping</strong> were noted to have suspicious relationships.</p>
<p>Their conversations were the area of focus to uncover their roles, relationships and identities.</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">Were there any other â€˜Eventâ€™ or â€˜Relationshipâ€™ nodes directly connected to Nadia in this communication network that hinted at suspicious people/ activities?</td>
<td style="text-align: left;">Based on information from question 2, <strong>Rodriguez</strong> was previously involved in <strong>mining activities</strong> that affected the environment. â€˜<strong>Mining</strong>â€™ as a topic and his conversations would be tracked.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="the-communication-timeline-and-content" class="level3">
<h3 class="anchored" data-anchor-id="the-communication-timeline-and-content">9.5.2 The Communication Timeline and Content:</h3>
<p>In the <code>nadia_full_communications_timeline</code> table, the actual content of her direct two-way communications were investigated over the course of 9 days. There were certain suspicious entities, keywords, coded language, or unusual topics detected that were suspicious. We have tabled out the segmented suspicious and non-suspicious entities for investigation and elimination.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Not in the Network but Mentioned in the Content</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Suspicious Entity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Non Suspicious Entity</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 76%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Entity</th>
<th>Form of Subject Matter</th>
<th>Rationale</th>
<th>Event ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nemo Reef</td>
<td>Location</td>
<td>Likely conservation area which was picked by the characters for illicit activities.</td>
<td>331, 943</td>
</tr>
<tr class="even">
<td>Permit #CR-7844</td>
<td>Item</td>
<td>Likely a permit to show tourism activity as a cover for suspicious activities. Rodriguez is likely linked to vessels Mako, Neptune, and Remora operating under this permit with a tourism facade.</td>
<td>582, 847, 805</td>
</tr>
<tr class="odd">
<td>EcoVigil</td>
<td>Vessel</td>
<td>EcoVigil will likely affect Nadiaâ€™s operations when they use their ROV. Nadia recommended to V. Miesel to accelerate the planned operation. They were likely working for different sides.</td>
<td>753, 847</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 61%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th>Suspicious Entity</th>
<th>Sub Type</th>
<th>Community</th>
<th>Rationale</th>
<th>Event ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Haacklee Harbor</td>
<td>Location</td>
<td>2</td>
<td>Nadiaâ€™s communication to Haacklee Harbor is suspicious when she wanted the documents destroyed and the special corridor to Nemo Reef cancelled.</td>
<td>331</td>
</tr>
<tr class="even">
<td>Liam aka The Middleman</td>
<td>Person</td>
<td>2</td>
<td>Nadia wanted him to double his usual fee to ensure Harbor Master remains cooperative. Identity revealed through:</td>
<td>529, 795, 847</td>
</tr>
<tr class="odd">
<td>Davis</td>
<td>Person</td>
<td>1</td>
<td>Nadia told him to create a clean paper trail. She will provide permits.</td>
<td>521</td>
</tr>
<tr class="even">
<td>Elise aka Mrs.&nbsp;Money</td>
<td>Person</td>
<td>1</td>
<td>Nadia warned Elise that conservation vessels might complicate their operation. Identity revealed through:</td>
<td>708, 528, 538, 677</td>
</tr>
<tr class="odd">
<td>Rodriguez aka Small Fry</td>
<td>Person</td>
<td>1</td>
<td>Linked to Mako, which is operating under a permit with a tourism facade.</td>
<td>805</td>
</tr>
<tr class="even">
<td>Remora</td>
<td>Vessel</td>
<td>1</td>
<td>Remora reported a tourism facade to Nadia and planned underwater lighting placements in Nemo Reef while monitoring conservation vessels.</td>
<td>943</td>
</tr>
<tr class="odd">
<td>Neptune</td>
<td>Vessel</td>
<td>1</td>
<td>Nadia told Neptune to stay under the radar.</td>
<td>538</td>
</tr>
<tr class="even">
<td>V. Miesel HQ</td>
<td>Organisation</td>
<td>1</td>
<td>Organisation was aware of the suspicious permit and The Middleman.</td>
<td>846, 847</td>
</tr>
<tr class="odd">
<td>Sailor Shifts Team aka Glitters Team</td>
<td>Organisation</td>
<td>1</td>
<td>Nadia provided crew members for the setup related to the permit.</td>
<td>520</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 65%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>Non Suspicious Entity</th>
<th>Sub Type</th>
<th>Community</th>
<th>Rationale</th>
<th>Event ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Oceanus City Council</td>
<td>Organisation</td>
<td>2</td>
<td>Oceanus City Council as a whole is not suspicious as an organisation as Liam stated this organisation suspected nothing.</td>
<td>535</td>
</tr>
<tr class="even">
<td>Sentinel</td>
<td>Vessel</td>
<td>2</td>
<td>Sentinel Vessel suspected ulterior motives as the water quality was fine.</td>
<td>677</td>
</tr>
<tr class="odd">
<td>Marlin</td>
<td>Vessel</td>
<td>2</td>
<td>Marlin inquired about unusual vessel routes near eastern shoals, Nadia and Davis might need to address this.</td>
<td>584</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="querying-keywords" class="level2">
<h2 class="anchored" data-anchor-id="querying-keywords"><strong>9.6 Querying Keywords</strong></h2>
<p>Based on our knowledge, we decided to connect to external information. We used knowledge from Nadiaâ€™s current network and communication with keyword search of our queries.</p>
<section id="plotted-timeline-word-query-permit-related" class="level3">
<h3 class="anchored" data-anchor-id="plotted-timeline-word-query-permit-related">9.6.1 Plotted Timeline (Word Query: Permit related)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 1: Define keywords</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"permit"</span>, <span class="st">"1045"</span>, <span class="st">"7844"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">b("</span>, <span class="fu">paste</span>(keywords, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="st">")</span><span class="sc">\\</span><span class="st">b"</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 2: Filter messages with keyword match (case-insensitive)</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>keyword_matches_df <span class="ot">&lt;-</span> other_communications_df <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">content_lower =</span> <span class="fu">tolower</span>(content)) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(content_lower, pattern))</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 3: Extract and annotate keyword matches</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> keyword_matches_df <span class="sc">%&gt;%</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">matched_keywords =</span> <span class="fu">str_extract_all</span>(content_lower, pattern),</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.POSIXct</span>(timestamp)),</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_date =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_time_of_day =</span> <span class="fu">suppressWarnings</span>(hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">format</span>(timestamp, <span class="st">"%H:%M:%S"</span>))),</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">wrapped_content =</span> <span class="fu">str_wrap</span>(content, <span class="at">width =</span> <span class="dv">50</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(matched_keywords) <span class="sc">%&gt;%</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">matched_keywords =</span> <span class="fu">recode</span>(matched_keywords,</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">"permit"</span> <span class="ot">=</span> <span class="st">"Permit"</span>,</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"1045"</span> <span class="ot">=</span> <span class="st">"# 1045"</span>,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"7844"</span> <span class="ot">=</span> <span class="st">"# 7844"</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip_text =</span> <span class="fu">paste0</span>(</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Date:&lt;/b&gt; "</span>, comm_date,</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;&lt;b&gt;Time:&lt;/b&gt; "</span>, <span class="fu">format</span>(comm_time_of_day, <span class="st">"%H:%M:%S"</span>),</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;&lt;b&gt;Event ID:&lt;/b&gt; "</span>, event_id,</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;&lt;b&gt;Content:&lt;/b&gt;&lt;br&gt;"</span>, wrapped_content</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 4: Plot timeline</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> comm_date, <span class="at">y =</span> comm_time_of_day)) <span class="sc">+</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> matched_keywords,</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> sender_sub_type,</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> tooltip_text,</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> matched_keywords</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Person"</span> <span class="ot">=</span> <span class="dv">16</span>,</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="dv">17</span>,</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Organization"</span> <span class="ot">=</span> <span class="dv">15</span>,</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Location"</span> <span class="ot">=</span> <span class="dv">18</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> matched_keywords, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"fixed"</span>) <span class="sc">+</span></span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_time</span>(</span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"13:00:00"</span>)),</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"09:00:00"</span>, <span class="st">"10:00:00"</span>, <span class="st">"11:00:00"</span>, <span class="st">"12:00:00"</span>, <span class="st">"13:00:00"</span>)),</span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"08:00"</span>, <span class="st">"09:00"</span>, <span class="st">"10:00"</span>, <span class="st">"11:00"</span>, <span class="st">"12:00"</span>, <span class="st">"13:00"</span>)</span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"1 day"</span>, <span class="at">date_labels =</span> <span class="st">"%d %b"</span>) <span class="sc">+</span></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Interactive Timeline: Keyword Mentions by Day and Time"</span>,</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Sender Type"</span>,</span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Keyword"</span></span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>), <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 5: Convert to plotly</span></span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="findings-in-sequential-order" class="level3">
<h3 class="anchored" data-anchor-id="findings-in-sequential-order">9.6.1.1 Findings in sequential order:</h3>
<ul>
<li>There were overlaps as the blue permit also included the red NR-1045 permit and green CR-7844 permit.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># Used for read_lines</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prepare data from the text provided</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>data_text <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="st">Date &amp; Time | Event Description</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="st">------------|---------------------------------------------------------------------------------------------------------------</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="st">2 Oct (12:16pm) | Rodriguez was from the Sailor Shifts Team.</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="st">5 Oct (10:54am) | Jensen from City Council approved Nemo Reef permit.</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="st">6 Oct (9:57am) | Remora told Sailor Shifts Team that Nadia got Commissioner Torres to sign off the permit.</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="st">6 Oct (10:45am) | Mako acknowledged NR-1045 permit to Nemo Reef.</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="st">6 Oct (12:33pm) | Mako was lead vessel to Neptune and Remora as authorised by V. Miesel Shipping.</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="st">7 Oct (9:40am) | Mako was operating under permit NR-1045 for conservation research.</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="st">8 Oct (10:24am) | Mako was operating under V. Miesel's special marine research permit CR-7844 approved by Oceanus City Council.</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="st">8 Oct (10:30am) | Mako informed Remora that both of them were operating under permit CR-7844 and have a 5 day deadline.</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="st">8 Oct (10:40am) | Remora was approved by Paackland Harbor to operate with extended hours under permit NR-1045.</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="st">9 Oct (11:53am) | Mako requesed for additional crew from v Miesel Shipping for the 24hr operations over next 5 days.</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="st">11 Oct (6:00am) | Nemo Reef closure mandated by Oceanus City Council.</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="st">11 Oct (8:57am) | All research permits must be submitted within 72 hours.</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="st">11 Oct (10:05am) | V. Miesel Shipping informed Remora that 30% of her crew to be reassigned to Neptune.</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="st">12 Oct (10:01am) | Davis as Captain oversaw crew reallocation.</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="st">12 Oct (11:19am) | Nadia secured documentation for CR-7844.</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a><span class="st">12 Oct (12:52pm) | Harbor closure for 3 days from 13 Oct 06:00.</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse the data into a data frame</span></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Use read_lines to handle the multi-line string</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>data_lines <span class="ot">&lt;-</span> <span class="fu">read_lines</span>(data_text)</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the header separator line and any empty lines</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>data_lines <span class="ot">&lt;-</span> data_lines[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"^---|==="</span>, data_lines) <span class="sc">&amp;</span> data_lines <span class="sc">!=</span> <span class="st">""</span>]</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a><span class="co"># The first non-separator line is the header</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>col_names_raw <span class="ot">&lt;-</span> <span class="fu">str_split</span>(data_lines[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\\</span><span class="st">|"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">str_trim</span>(col_names_raw)</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a><span class="co"># The rest are data rows</span></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>data_content <span class="ot">&lt;-</span> data_lines[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame by splitting lines and putting into a tibble</span></span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">line =</span> data_content) <span class="sc">%&gt;%</span></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Date &amp; Time</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">str_trim</span>(<span class="fu">str_extract</span>(line, <span class="st">"^[^|]+"</span>)),</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Event Description</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">str_trim</span>(<span class="fu">str_extract</span>(line, <span class="st">"(?&lt;=</span><span class="sc">\\</span><span class="st">|).+$"</span>))</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Date &amp; Time</span><span class="st">`</span>, <span class="st">`</span><span class="at">Event Description</span><span class="st">`</span>) <span class="co"># Ensure correct column order and names</span></span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create the reactable table with desired features</span></span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a>  df,</span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="co"># Enable column-specific filters (from the tutorial)</span></span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="co"># Enable global search box (from the tutorial)</span></span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">paginationType =</span> <span class="st">"numbers"</span>, <span class="co"># Display page numbers (corrected from "pages")</span></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="co"># Show 5 rows per page</span></span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="co"># Allow users to change page size</span></span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">50</span>), <span class="co"># Options for page sizes</span></span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="co"># Add alternating row colors (from the tutorial)</span></span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="co"># Highlight row on hover (from the tutorial)</span></span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Date &amp; Time</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(</span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Date &amp; Time"</span>,</span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">120</span>, <span class="co"># Adjust width to fit content</span></span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"left"</span></span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Event Description</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(</span>
<span id="cb57-69"><a href="#cb57-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Event Description"</span>,</span>
<span id="cb57-70"><a href="#cb57-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">500</span>, <span class="co"># Ensure enough width for event descriptions</span></span>
<span id="cb57-71"><a href="#cb57-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"left"</span></span>
<span id="cb57-72"><a href="#cb57-72" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-73"><a href="#cb57-73" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb57-74"><a href="#cb57-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply a custom theme for better aesthetics (inspired by the tutorial)</span></span>
<span id="cb57-75"><a href="#cb57-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb57-76"><a href="#cb57-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#dfe2e5"</span>,</span>
<span id="cb57-77"><a href="#cb57-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span>,</span>
<span id="cb57-78"><a href="#cb57-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightColor =</span> <span class="st">"#f0f5f9"</span>,</span>
<span id="cb57-79"><a href="#cb57-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">cellPadding =</span> <span class="st">"8px 12px"</span>,</span>
<span id="cb57-80"><a href="#cb57-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontFamily =</span> <span class="st">"Verdana, Geneva, sans-serif"</span>, <span class="at">fontSize =</span> <span class="st">"14px"</span>),</span>
<span id="cb57-81"><a href="#cb57-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb57-82"><a href="#cb57-82" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;.rt-th:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">backgroundColor =</span> <span class="st">"#e0e6eb"</span>),</span>
<span id="cb57-83"><a href="#cb57-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">fontSize =</span> <span class="st">"15px"</span>,</span>
<span id="cb57-84"><a href="#cb57-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">fontWeight =</span> <span class="dv">600</span>,</span>
<span id="cb57-85"><a href="#cb57-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"#333"</span>, <span class="co"># Darker header text for contrast</span></span>
<span id="cb57-86"><a href="#cb57-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">background =</span> <span class="st">"#f7f7f7"</span> <span class="co"># Slightly grey background for header</span></span>
<span id="cb57-87"><a href="#cb57-87" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-88"><a href="#cb57-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">rowSelectedStyle =</span> <span class="fu">list</span>(<span class="at">backgroundColor =</span> <span class="st">"#e6f2ff"</span>, <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">backgroundColor =</span> <span class="st">"#e6f2ff"</span>)),</span>
<span id="cb57-89"><a href="#cb57-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Styles for search/filter inputs (from tutorial's theme example)</span></span>
<span id="cb57-90"><a href="#cb57-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchInputStyle =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">margin =</span> <span class="st">"5px 0"</span>, <span class="at">padding =</span> <span class="st">"5px"</span>),</span>
<span id="cb57-91"><a href="#cb57-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">filterInputStyle =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">margin =</span> <span class="st">"2px 0"</span>, <span class="at">padding =</span> <span class="st">"4px"</span>)</span>
<span id="cb57-92"><a href="#cb57-92" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-93"><a href="#cb57-93" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>Since there were little communications on 13 Oct, we looked into other word queries.</p></li>
<li><p>Using information obtained from question 2 and 4, we had in mind certain keywords to query for.</p></li>
</ul>
</section>
<section id="plotted-timeline-word-query-music-video-related" class="level3">
<h3 class="anchored" data-anchor-id="plotted-timeline-word-query-music-video-related">9.6.2 Plotted Timeline (Word Query: Music Video Related)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hms)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 1: Define keywords</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mine"</span>, <span class="st">"mining"</span>, <span class="st">"music video"</span>, <span class="st">"lighting"</span>, <span class="st">"reef operation"</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">b("</span>, <span class="fu">paste</span>(keywords, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="st">")</span><span class="sc">\\</span><span class="st">b"</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 2: Filter messages</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>search_target_content <span class="ot">&lt;-</span> <span class="fu">tolower</span>(other_communications_df<span class="sc">$</span>content)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>keyword_matches_df <span class="ot">&lt;-</span> other_communications_df <span class="sc">%&gt;%</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(search_target_content, pattern))</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 3: Extract keywords</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> keyword_matches_df <span class="sc">%&gt;%</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">matched_keywords =</span> <span class="fu">str_extract_all</span>(<span class="fu">tolower</span>(content), pattern)) <span class="sc">%&gt;%</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(matched_keywords) <span class="sc">%&gt;%</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">matched_keywords =</span> <span class="fu">str_to_title</span>(matched_keywords)) <span class="sc">%&gt;%</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(matched_keywords, timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">as.POSIXct</span>(timestamp),</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_date =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">comm_time_of_day =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">format</span>(timestamp, <span class="st">"%H:%M:%S"</span>)),</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">wrapped_content =</span> <span class="fu">str_wrap</span>(content, <span class="at">width =</span> <span class="dv">50</span>),</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip_text =</span> <span class="fu">paste0</span>(</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;b&gt;Date:&lt;/b&gt; "</span>, comm_date,</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;&lt;b&gt;Time:&lt;/b&gt; "</span>, comm_time_of_day,</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;&lt;b&gt;Event ID:&lt;/b&gt; "</span>, event_id,</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;&lt;b&gt;From:&lt;/b&gt; "</span>, sender_name,</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;&lt;b&gt;To:&lt;/b&gt; "</span>, recipient_name,</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;&lt;b&gt;Content:&lt;/b&gt;&lt;br&gt;"</span>, wrapped_content</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 4: Plot</span></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> comm_date, <span class="at">y =</span> comm_time_of_day)) <span class="sc">+</span></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> matched_keywords,</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> sender_sub_type,</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> tooltip_text,</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> matched_keywords  <span class="co"># ensures matched_keywords is in layer</span></span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Person"</span> <span class="ot">=</span> <span class="dv">16</span>,</span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="dv">17</span>,</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Organization"</span> <span class="ot">=</span> <span class="dv">15</span>,</span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Location"</span> <span class="ot">=</span> <span class="dv">18</span></span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> matched_keywords, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"fixed"</span>) <span class="sc">+</span></span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_time</span>(</span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"13:00:00"</span>)),</span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">c</span>(<span class="st">"08:00:00"</span>, <span class="st">"09:00:00"</span>, <span class="st">"10:00:00"</span>, <span class="st">"11:00:00"</span>, <span class="st">"12:00:00"</span>, <span class="st">"13:00:00"</span>)),</span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"08:00"</span>, <span class="st">"09:00"</span>, <span class="st">"10:00"</span>, <span class="st">"11:00"</span>, <span class="st">"12:00"</span>, <span class="st">"13:00"</span>)</span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"1 day"</span>, <span class="at">date_labels =</span> <span class="st">"%d %b"</span>) <span class="sc">+</span></span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Interactive Timeline: Keyword Mentions by Day and Time"</span>,</span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Sender Type"</span>,</span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Keyword"</span></span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>), <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),  <span class="co"># Applies to both x and y spacing</span></span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Step 5: Convert to plotly</span></span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="findings-through-questions-answers" class="level3">
<h3 class="anchored" data-anchor-id="findings-through-questions-answers">9.6.2.1 Findings through Questions &amp; Answers:</h3>
<section id="question-and-answer-analysis-1" class="level4">
<h4 class="anchored" data-anchor-id="question-and-answer-analysis-1"><strong>Question and Answer Analysis</strong></h4>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Question</strong></th>
<th><strong>Answer</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Which vessel was the suspicious permit #CR-7844 prepared for?</p>
<p>(See 9.6.1.1)</p></td>
<td>From question 2 and 4, we know this is V. Mieselâ€™s Marine Research Permit, and prepared for Mako (lead vessel), Neptune, and Remora.</td>
</tr>
<tr class="even">
<td><p>What suspicious activity was performed at Nemo Reef? Which day was it?</p>
<p>(See 9.6.2)</p></td>
<td>14 Oct 2040 for a music video production.</td>
</tr>
<tr class="odd">
<td><p>Why is underwater lighting placement needed at Nemo Reef?</p>
<p>(See 9.6.2)</p></td>
<td>For a music video production.</td>
</tr>
<tr class="even">
<td><p>What were the expedited approvals and secretive logistics?</p>
<p>(See 9.6.1 and 9.6.2)</p></td>
<td>Permits for Nemo Reef through NR-1045 and CR-788 were expedited. The secretive logistics were the crates and equipment on the vessels for the music video production.</td>
</tr>
<tr class="odd">
<td><p>Who were the high-level Oceanus officials, Sailor Shiftâ€™s team, local influential families, and local conservationist group?</p>
<p>(Various Ids)</p></td>
<td><p><strong>Oceanus Officials</strong>: Commissioner Blake, Commissioner Torres, Council Knowles, The Middleman, Jensen, Liam Thorne</p>
<p><strong>Sailor Shiftâ€™s Team</strong>: Boss, Council Knowles, Davis, Glitters Team, Liam Thorne, Mako, Mrs.&nbsp;Money, Nadia, Neptune, Remora, Rodriguez, Sam, Samantha Blake, Small Fry, The Accountant, The Intern, The Middleman</p>
<p><strong>Local Influential Families</strong>: Council Knowles, V. Miesel Shipping</p>
<p><strong>Local Conservationist Group</strong>: Defender, EcoVigil, Green Guardians, Horizon, Kelly, Reef Guardians, Seawatch, Sentinel, The Lookout</p></td>
</tr>
<tr class="even">
<td><p>Was the music video production activity legal?</p>
<p>(Id 979)</p></td>
<td>There was no environmental damage or mining involved in the music production. However, an environmental assessment was not conducted prior. Clepper may assess that his suspicions about Nadia Contiâ€™s illicit activity may not be straightforward and could depend on whether an assessment was mandatory before commercial activities.</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>
<section id="recreation-of-story-line" class="level1">
<h1><strong>10) Recreation of Story-Line</strong></h1>
<p>Here we attempted to summarise the story-line.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 0: Define Event Data for Annotations ---</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>event_dates <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2040-10-01"</span>, <span class="st">"2040-10-03"</span>, <span class="st">"2040-10-04"</span>, <span class="st">"2040-10-05"</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"2040-10-06"</span>, <span class="st">"2040-10-08"</span>, <span class="st">"2040-10-09"</span>, <span class="st">"2040-10-11"</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"2040-10-12"</span>, <span class="st">"2040-10-14"</span>))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>event_labels_full <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The Middleman told The Boss (Nadia) about a potential loophole in Nemo Reef protection zone"</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tourism vessels were offering authorised access. Their violations were addressed at City Council meeting"</span>,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Nadia told Mako to abort Nemo Reef mission as conservation vessels were close"</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"News of Nadia assisting to get permit for Nemo Reef signed by Jensen from City Council on 4/10 spreaded"</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"V. Miesel Shipping HQ told Neptune that Mako is lead vessel"</span>,</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Neptune told Mako they were under special marine research permit CR-7844"</span>,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Neptune's underwater concrete forms in fragile crates discovered"</span>,</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"37 'authorised maintenance vessels' documented despite Nemo Reef closure"</span>,</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Crew reallocated from Remona to Neptune overseen by Captain Davis"</span>,</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Music video production after Nemo Reef equipment transfer"</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>event_labels_short <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Loophole"</span>, <span class="st">"Tourism"</span>, <span class="st">"Mako"</span>, <span class="st">"Permit</span><span class="sc">\n</span><span class="st">Results"</span>, <span class="st">"#NR-1045"</span>,</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#CR-7844"</span>, <span class="st">"Underwater</span><span class="sc">\n</span><span class="st">Structure"</span>, <span class="st">"37 Vessels"</span>, <span class="st">"Shifted Crew"</span>, <span class="st">"MV</span><span class="sc">\n</span><span class="st">Production"</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 1: Calculate Daily Message Frequencies ---</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>freq_df <span class="ot">&lt;-</span> other_communications_df <span class="sc">%&gt;%</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comm_date =</span> <span class="fu">as.Date</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(comm_date, <span class="at">name =</span> <span class="st">"message_count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Complete the date range to include all days, filling missing counts with 0</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(<span class="at">comm_date =</span> <span class="fu">seq</span>(<span class="fu">min</span>(comm_date), <span class="fu">max</span>(comm_date), <span class="at">by =</span> <span class="st">"day"</span>),</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">message_count =</span> <span class="dv">0</span>))</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 2: Build Event Annotation Table ---</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>event_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> event_dates,</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"&lt;br&gt;"</span>, event_labels_short), <span class="co"># Replace \n with &lt;br&gt; for HTML tooltips</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">tooltip_raw =</span> <span class="fu">str_wrap</span>(event_labels_full, <span class="at">width =</span> <span class="dv">40</span>) <span class="co"># Wrap long text for tooltips</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>core_events <span class="ot">&lt;-</span> event_df <span class="sc">%&gt;%</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(freq_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"date"</span> <span class="ot">=</span> <span class="st">"comm_date"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">offset =</span> <span class="fu">row_number</span>(), <span class="co"># For stacking multiple events on the same day</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust value for arrow positioning relative to message count</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as.numeric</span>(message_count) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> offset,</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_jitter =</span> date <span class="sc">+</span> (offset <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fl">0.1</span> <span class="co"># Slight horizontal jitter if multiple events</span></span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create rich HTML tooltip content for Plotly</span></span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip =</span> <span class="fu">paste0</span>(</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>      <span class="st">"ðŸ“… &lt;b&gt;Date:&lt;/b&gt; "</span>, date,</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;âœ‰ï¸ &lt;b&gt;Messages:&lt;/b&gt; "</span>, message_count,</span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;ðŸ“ &lt;b&gt;Core Event:&lt;/b&gt; "</span>, tooltip_raw</span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 3: Create the ggplot2 Plot ---</span></span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_df, <span class="fu">aes</span>(<span class="at">x =</span> comm_date, <span class="at">y =</span> message_count)) <span class="sc">+</span></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Line plot for message frequency</span></span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"navyblue"</span>) <span class="sc">+</span></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Segments (arrows) pointing from the line to the event annotations</span></span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> core_events,</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">xend =</span> date, <span class="at">y =</span> value <span class="sc">-</span> <span class="dv">1</span>, <span class="at">yend =</span> value <span class="sc">+</span> <span class="fl">0.5</span>), <span class="co"># Adjust yend for arrow tip</span></span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>)), <span class="at">color =</span> <span class="st">"grey40"</span></span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Points for the events (these will have the interactive tooltips)</span></span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> core_events,</span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">text =</span> tooltip), <span class="co"># 'text' aesthetic is key for Plotly tooltips</span></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span>, <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Text labels for the short event names</span></span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> core_events,</span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value <span class="sc">+</span> <span class="dv">2</span>, <span class="at">label =</span> label), <span class="co"># Position text above the point/arrow</span></span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">vjust =</span> <span class="dv">0</span></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X-axis scale for dates</span></span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"1 day"</span>, <span class="at">date_labels =</span> <span class="st">"%b %d"</span>) <span class="sc">+</span></span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels and titles</span></span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Message Frequency Over Time"</span>,</span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Message Count"</span></span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure annotations are not clipped by plot limits</span></span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Minimal theme for a clean look</span></span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Further theme adjustments</span></span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">10</span>, <span class="dv">10</span>), <span class="co"># Adjust plot margins if needed</span></span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 4: Convert to Interactive Plotly Object ---</span></span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a><span class="co"># The 'tooltip = "text"' argument tells Plotly to use the 'text' aesthetic</span></span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a><span class="co"># for the hover information, which we created as 'tooltip' in core_events.</span></span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a>p_interactive <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 5: Display the Interactive Plot ---</span></span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true" tabindex="-1"></a>p_interactive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Hover over the red points to see the details. Here, we provided a high level summary on the core event on the preparation and production of the music video Nadia was involved in for a period of 2 weeks, and also provided a snippet to the sub-event of the tourism vessels breaching protocols earlier in the week.</p>
</section>
<section id="references" class="level1">
<h1><strong>11) References</strong></h1>
<ul>
<li><p>Datastorm (2021) <a href="https://datastorm-open.github.io/visNetwork/">visNetwork</a></p></li>
<li><p>Dr.&nbsp;Kam Tin Seong (2025) <a href="https://isss608-ay2024-25apr.netlify.app/outline/lesson09_outline">Lesson 9: Visualising and Analysis Network Data</a></p></li>
<li><p>R-Graph (2025) <a href="https://r-graph-gallery.com/package/reactable.html">Reactable</a></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>